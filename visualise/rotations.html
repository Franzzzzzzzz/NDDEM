<!DOCTYPE html>
<html lang="en">
	<head>
		<title>MuDEM</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="node_modules/three/build/three.js"></script>
        <script src="node_modules/three/examples/js/WebGL.js"></script>
        <script src="node_modules/three/examples/js/controls/TrackballControls.js"></script>
        <script src="node_modules/three/examples/js/controls/OrbitControls.js"></script>
        <script src="node_modules/three/examples/js/libs/dat.gui.min.js"></script>
        <script>

        function update_texture(t) {
            if ( sphere !== undefined ) {
                sphere.material.map.offset.x = t/10.;/// console.log(t);
            }
        };

        clock = new THREE.Clock();
        var scene = new THREE.Scene();
        scene.background = new THREE.Color( 0x111111 );
		var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );
		camera.position.z = 4;
        camera.position.x = 1.5;
        // camera.rotation.y = Math.PI;
        // camera.rotation.z = Math.PI;

		var renderer = new THREE.WebGLRenderer();
        // var controls = new THREE.TrackballControls( camera, renderer.domElement );
		renderer.setSize( window.innerWidth, window.innerHeight );
		document.body.appendChild( renderer.domElement );

        var background_light = new THREE.AmbientLight( 0xffffff );
        scene.add( background_light );
        var light = new THREE.DirectionalLight(0x505050);
        light.position.x = -2
        light.position.z = 2
        scene.add( light );

        var sphere;
        var rect;

        var loader = new THREE.TextureLoader()
            .load( "http://localhost:8000/" + "visualise/resources/earth2d.jpg", function( texture ) {
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                var sphere_geometry = new THREE.SphereGeometry( 1, 32, 32 );
                var rect_geometry = new THREE.PlaneBufferGeometry( 1, 1 );

                var material = new THREE.MeshStandardMaterial( { map: texture } );
                sphere = new THREE.Mesh( sphere_geometry, material );
                rect = new THREE.Mesh( rect_geometry, material );
                sphere.position.x = -1
                rect.position.x = 3
                rect.scale.set(4,2,1);
                rect.rotation.z = Math.PI;
                sphere.rotation.z = Math.PI;
                sphere.rotation.y = Math.PI/2.;

                scene.add( sphere );
                scene.add( rect );
            } );


        // var sphere  = new THREE.Mesh( sphere_geometry, material );
        // var rect  = new THREE.Mesh( rect_geometry, material );


        // var gui = new dat.GUI();
        // gui.add( slice, 'loc').min(-1).max(1).step(0.01).listen().name('Slice').onChange( function( val ) { update_spheres(val); }) ;
        // gui.open();

		var animate = function () {
            // controls.update();
            update_texture( clock.getElapsedTime() );
			requestAnimationFrame( animate );
			renderer.render( scene, camera );

		};
        window.addEventListener( 'resize', onWindowResize, false );
		animate();

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize( window.innerWidth, window.innerHeight );
            controls.handleResize();
        };
        </script>

	</body>
</html>
