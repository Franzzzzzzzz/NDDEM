
variable d equal 0.0015
variable peau equal  2*$d
variable rho equal 2500

atom_style     granular
boundary       p p p


newton          off
communicate     single vel yes
units          si
region         reg block 0 0.005 0 0.001 0 0.01  units box
create_box     2 reg

neighbor        ${peau} bin
#neigh_modify   every 1 check yes
neigh_modify    delay 0


pair_style      gran model hooke/stiffness tangential history tangential_damping on limitForce off absolute_damping on
pair_coeff      * *
fix             m1 all property/global kn peratomtypepair 2 8.1e5 8.1e5 8.1e5 8.1e5
fix             m2 all property/global kt peratomtypepair 2 8e4 8e4 8e4 8e4
fix             m3 all property/global gamman_abs peratomtypepair 2 0.1 0.1 0.1 0.1
fix             m4 all property/global gammat_abs peratomtypepair 2 0 0 0 0
fix             m5 all property/global coefficientFriction peratomtypepair 2 0.5 0.000001 0.000001 0.000001

timestep        0.000001

fix             floor all wall/gran model hooke/stiffness tangential history primitive type 1 zplane 0 store_force yes tangential_damping on limitForce off absolute_damping on
#fix             ceiling all wall/gran model hooke/stiffness tangential history primitive type 1 zplane 1 store_force yes tangential_damping on limitForce off absolute_damping on

create_atoms 1 single 0.00075 0.00075 0.00075
create_atoms 1 single 0.00225 0.00075 0.00075
create_atoms 1 single 0.00375 0.00075 0.00075
create_atoms 1 single 0.00075 0.00075 0.00225
create_atoms 1 single 0.00225 0.00075 0.00225
create_atoms 1 single 0.00375 0.00075 0.00225
create_atoms 1 single 0.00075 0.00075 0.00375
create_atoms 1 single 0.00225 0.00075 0.00375
create_atoms 1 single 0.00375 0.00075 0.00375
create_atoms 1 single 0.00075 0.00075 0.00525

set     type 1 diameter $d density ${rho}

#group   gp2 id 2
fix     1 all gravity 0.9254 vector 0.1 0 -0.92
#fix     2 gp2 freeze



fix             integr all nve/sphere
#fix 2 frozen freeze

dump dumping all custom 10000 dump.myforce id x y z omegax omegay omegaz
#dump dumping2 all atom/vtk 100 dump.atom-*.vtk


thermo_style custom step
thermo 10000
run 1000000
