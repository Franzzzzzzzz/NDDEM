<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NDDEM: /home/runner/work/NDDEM/NDDEM/src/Dem/DEMND.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NDDEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_60f163d56f204d8b3665b29b13f4a292.html">Dem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DEMND.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DEMND_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;ctime&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef NO_OPENMP</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">    #include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoarseGraining_2Typedefs_8h.html">Typedefs.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoarseGraining_2Parameters_8h.html">Parameters.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Contacts_8h.html">Contacts.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ContactList_8h.html">ContactList.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Multiproc_8h.html">Multiproc.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Cells_8h.html">Cells.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Boundaries_8h.html">Boundaries.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifdef EMSCRIPTEN</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">    #include &lt;emscripten.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">    #include &lt;emscripten/bind.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespaceemscripten.html">emscripten</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">extern</span> vector &lt;std::pair&lt;ExportType,ExportData&gt;&gt; * <a class="code" href="group__DEM.html#gac20448335ecd8c809838b374144f5957">toclean</a> ;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">extern</span> <a class="code" href="classXMLWriter.html">XMLWriter</a> * <a class="code" href="group__DEM.html#gacabf51e402a05a98437894859ed3d834">xmlout</a> ;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> d&gt;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classSimulation.html">   57</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSimulation.html">Simulation</a> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classSimulation.html#ae0765646809d18926387ad69004f194f">   59</a></span>&#160;    <a class="code" href="classParameters.html">Parameters&lt;d&gt;</a> <a class="code" href="classSimulation.html#ae0765646809d18926387ad69004f194f">P</a> ;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classSimulation.html#a0bfd8350d84ab9a69ec19742836b3c83">   60</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classSimulation.html#a0bfd8350d84ab9a69ec19742836b3c83">N</a> ;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classSimulation.html#ada00ac80b5ad3a4b437dc34626d33e3a">   61</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#ada00ac80b5ad3a4b437dc34626d33e3a">X</a> ;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classSimulation.html#a191c30360dc18bfcb50414f65837e803">   62</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a191c30360dc18bfcb50414f65837e803">V</a> ;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classSimulation.html#a26d5c37e220b5f586552bc1aa2b44adb">   63</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a26d5c37e220b5f586552bc1aa2b44adb">A</a> ;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classSimulation.html#ae76c72cd7640bdb5c3e23d1445dcbdf3">   64</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#ae76c72cd7640bdb5c3e23d1445dcbdf3">Omega</a> ;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classSimulation.html#afa3cd19e5b3c33933de66b06d00c084c">   65</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#afa3cd19e5b3c33933de66b06d00c084c">F</a> ;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classSimulation.html#a09004b85cc83d2530259200377be3ac7">   66</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a09004b85cc83d2530259200377be3ac7">FOld</a> ;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classSimulation.html#a46542e885c635e3ea22a50ef9d36f81a">   67</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a46542e885c635e3ea22a50ef9d36f81a">Torque</a> ;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classSimulation.html#abf0d6ade6126c8d8bcc17c16fcc1c32c">   68</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#abf0d6ade6126c8d8bcc17c16fcc1c32c">TorqueOld</a> ;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classSimulation.html#a0c8affa1326621a579c5f73a0c09a62d">   69</a></span>&#160;    std::vector &lt; double &gt; <a class="code" href="classSimulation.html#a0c8affa1326621a579c5f73a0c09a62d">Vmag</a> ;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classSimulation.html#af024b857f483ca4d9111487dae4e7633">   70</a></span>&#160;    std::vector &lt; double &gt; <a class="code" href="classSimulation.html#af024b857f483ca4d9111487dae4e7633">OmegaMag</a> ;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classSimulation.html#a4baeea0b400f3894c7d42791a7f75328">   71</a></span>&#160;    std::vector &lt; double &gt; <a class="code" href="classSimulation.html#a4baeea0b400f3894c7d42791a7f75328">Z</a> ;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classSimulation.html#a1261b3ec74221189cfd15079182f6246">   72</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a1261b3ec74221189cfd15079182f6246">Fcorr</a> ;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classSimulation.html#ad661e05befbcf21f70fc2dc9594f570b">   73</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#ad661e05befbcf21f70fc2dc9594f570b">TorqueCorr</a>  ;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        </div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classSimulation.html#a5fc027c6f24f5b846a0567ca7fc2d19a">   75</a></span>&#160;    std::vector &lt; std::optional&lt;int&gt; &gt; <a class="code" href="classSimulation.html#a5fc027c6f24f5b846a0567ca7fc2d19a">RigidBodyId</a> ; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classSimulation.html#a4dc8ed0a8598f6ba5242f05ec207a205">   77</a></span>&#160;    std::vector &lt;SpecificAction&lt;d&gt;&gt; <a class="code" href="classSimulation.html#a4dc8ed0a8598f6ba5242f05ec207a205">ExternalAction</a> ;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classSimulation.html#a486ae99dfeb707ec8b1a29e02b754222">   79</a></span>&#160;    std::vector &lt;uint32_t&gt; <a class="code" href="classSimulation.html#a486ae99dfeb707ec8b1a29e02b754222">PBCFlags</a> ;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classSimulation.html#aef49d4beef65281ea392a0e5806d7399">   80</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#aef49d4beef65281ea392a0e5806d7399">WallForce</a> ;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classSimulation.html#abf0c3c4b447a95d9d03ce4ecb8dde8e6">   81</a></span>&#160;    std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="classSimulation.html#abf0c3c4b447a95d9d03ce4ecb8dde8e6">empty_array</a> ;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classSimulation.html#a47f7361b016f2ff32e4b26741af0616e">   82</a></span>&#160;    std::vector &lt; std::vector &lt;double&gt; &gt; <a class="code" href="classSimulation.html#a47f7361b016f2ff32e4b26741af0616e">ParticleForce</a> ;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classSimulation.html#a97ea76d8dbe30376f60b3308f0bc856f">   84</a></span>&#160;    vector &lt;uint32_t&gt; <a class="code" href="classSimulation.html#a97ea76d8dbe30376f60b3308f0bc856f">Ghost</a> ;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classSimulation.html#a025db6580b4b23035d281c6ab3179eb8">   85</a></span>&#160;    vector &lt;uint32_t&gt; <a class="code" href="classSimulation.html#a025db6580b4b23035d281c6ab3179eb8">Ghost_dir</a> ;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classSimulation.html#a0cdc83ac25525f2908926f6d2ea54ebe">   86</a></span>&#160;    <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> <a class="code" href="classSimulation.html#a0cdc83ac25525f2908926f6d2ea54ebe">Atmp</a> ;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classSimulation.html#af15ce947a00d082b61729632a12a67aa">   88</a></span>&#160;    <span class="keywordtype">int</span> numthread=1 ;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classSimulation.html#a38838d855fb6de256fc59825e0f72520">   89</a></span>&#160;    <a class="code" href="classMultiproc.html">Multiproc&lt;d&gt;</a> <a class="code" href="classSimulation.html#a38838d855fb6de256fc59825e0f72520">MP</a> ;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classSimulation.html#a1866609acd84ffa7f64127921ea40316">   90</a></span>&#160;    <a class="code" href="classCells.html">Cells&lt;d&gt;</a> <a class="code" href="classSimulation.html#a1866609acd84ffa7f64127921ea40316">cells</a> ; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classSimulation.html#a8d3c309593a4596780564b62e86cb594">   92</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classSimulation.html#a8d3c309593a4596780564b62e86cb594">t</a> ; <span class="keywordtype">int</span> ti ;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classSimulation.html#a2fe4bca258c4a054990e32ba791d7d00">   93</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classSimulation.html#a2fe4bca258c4a054990e32ba791d7d00">dt</a> ;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classSimulation.html#ad2d47b656e6452943a83228cf0bdeb31">   94</a></span>&#160;    clock_t <a class="code" href="classSimulation.html#ad2d47b656e6452943a83228cf0bdeb31">tnow</a>, tprevious ;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//==========================================================</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classSimulation.html#a85783d8fe6508bc90f4455f69c65ceee">   97</a></span>&#160;    <a class="code" href="classSimulation.html#a85783d8fe6508bc90f4455f69c65ceee">Simulation</a>(<span class="keywordtype">int</span> NN) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        P = <a class="code" href="classParameters.html">Parameters&lt;d&gt;</a>(NN) ;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="group__DEM.html#gaeadcd7def825af49f5f3b33e62d94a18">Tools&lt;d&gt;::initialise</a>() ;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classTools.html">Tools&lt;d&gt;::check_initialised</a>(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>)) printf(<span class="stringliteral">&quot;ERR: Something terribly wrong happened\n&quot;</span>) ;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        assert(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>&lt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))*8-1)) ; <span class="comment">//TODO</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// Array initialisations</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>=P.<a class="code" href="classParameters.html#a578a6da9fd91e0154574903f750440f9">N</a> ;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        X.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// X[0][0] = 123;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        V.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        A.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;N ; i++) A[i]=Tools&lt;d&gt;::Eye ;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Omega.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2, 0)) ; <span class="comment">//Rotational velocity matrix (antisymetrical)</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        F.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        FOld.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        Torque.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2, 0)) ;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        TorqueOld.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2, 0)) ;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Vmag.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>,0) ;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        OmegaMag.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>,0) ;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Z.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>,0) ;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Fcorr.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0)) ;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        TorqueCorr.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2, 0)) ;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        RigidBodyId.resize(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>,{}) ; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        PBCFlags.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, 0) ;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        WallForce.resize (2*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, std::vector &lt;double&gt; (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0)) ;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        empty_array.resize(1, std::vector &lt;double&gt; (1, 0)) ;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Ghost.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, 0) ;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Ghost_dir.resize (<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, 0) ;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        Atmp.resize (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>, 0) ;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// Initial state setup</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        P.<a class="code" href="classParameters.html#a7d880b12e436cfb1d597d8a946ec1738">set_boundaries</a>() ;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classSimulation.html#a4aa574e603c9a9013d4663a51cc53df7">  136</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classSimulation.html#a4aa574e603c9a9013d4663a51cc53df7">init_from_file</a> (<span class="keywordtype">char</span> filename[])</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      P.<a class="code" href="classParameters.html#a0c27d0ee94ac521382bfbe4b2f9513b6">load_datafile</a> (filename, X, V, Omega) ;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="group__API.html#gae5dc1304be206295da37e4045d95b3a9">  145</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="group__API.html#gae5dc1304be206295da37e4045d95b3a9">finalise_init</a> () {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">//if (strcmp(argv[3], &quot;default&quot;))</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">//    P.load_datafile (argv[3], X, V, Omega) ;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="group__DEM.html#gac20448335ecd8c809838b374144f5957">toclean</a> = &amp;(P.<a class="code" href="classParameters.html#ae9dea3a3136542135ae052ff207f2aeb">dumps</a>) ;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="group__DEM.html#gacabf51e402a05a98437894859ed3d834">xmlout</a> = P.<a class="code" href="classParameters.html#a1b92dd8955440c8d8f836bb1bc3dfc19">xmlout</a> ;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        P.<a class="code" href="classParameters.html#a5978769dfdb3e594fa2f7e72b042968d">RigidBodies</a>.allocate (RigidBodyId) ; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">        #ifndef NO_OPENMP</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">char</span>* env_p = std::getenv(<span class="stringliteral">&quot;OMP_NUM_THREADS&quot;</span>) ;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">if</span> (env_p!=<span class="keyword">nullptr</span>) numthread = atoi (env_p) ;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          omp_set_num_threads(numthread) ;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        MP.<a class="code" href="classMultiproc.html#af469cf9d0075a8d76d22de5980b8602f">initialise</a>(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>, numthread, P) ;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a> == <a class="code" href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">ContactStrategies::CELLS</a>) </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            printf(<span class="stringliteral">&quot;INITIALISE CELLS\n&quot;</span>) ; fflush(stdout) ;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keyword">auto</span> rmax = std::max_element(P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>.begin(), P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>.end()) ;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            printf(<span class="stringliteral">&quot;%g &quot;</span>, *rmax) ;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            cells.<a class="code" href="classCells.html#af960620aaf7a9db4f08da964ec16db4b">init_cells</a>(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>, P.<a class="code" href="classParameters.html#aaab9f999922f58587ee5a5a3aec7f42c">cellsize</a>==-1?(*rmax*2.1):P.<a class="code" href="classParameters.html#aaab9f999922f58587ee5a5a3aec7f42c">cellsize</a>) ;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            MP.<a class="code" href="group__DEM.html#gae0ec2e6c3cf902e89fb57ee9b5b16622">splitcells</a>(cells.<a class="code" href="classCells.html#acf33aa402cddc885c1e41b91f5a4dbd9">cells</a>.size()) ; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            MP.<a class="code" href="classMultiproc.html#ad7e0402a4f8c180d27f4977d57b064b8">CLp_all</a>.init_for_cells(<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a>) ; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        dt=P.<a class="code" href="classParameters.html#a980a4800c7649a3b227bba551a53621d">dt</a> ;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        t=0 ; ti=0 ;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        tprevious=clock() ;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        printf(<span class="stringliteral">&quot;[INFO] Orientation tracking is %s\n&quot;</span>, P.<a class="code" href="classParameters.html#a0a9d02b87e701c2839b40bc1035f594b">orientationtracking</a>?<span class="stringliteral">&quot;True&quot;</span>:<span class="stringliteral">&quot;False&quot;</span>) ;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="group__API.html#ga35da1ce034dd12fa4e52df7308b4a2c5">  181</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga35da1ce034dd12fa4e52df7308b4a2c5">interpret_command</a> (<span class="keywordtype">string</span> in)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        P.<a class="code" href="classParameters.html#ade324b0055d861d22b1158c90716a9e3">interpret_command</a>(in, X,V,Omega) ;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classSimulation.html#af2e37424452fc0690285d330c1290805">  189</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classSimulation.html#af2e37424452fc0690285d330c1290805">step_forward_all</a> ()</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordtype">int</span> nsteps = P.<a class="code" href="classParameters.html#a43c244f24421c088502ad8dd46032e0e">T</a>/dt ;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      step_forward(nsteps) ;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//----</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="group__API.html#ga3e04516c50d59dfa46615be8c0253fe1">  199</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga3e04516c50d59dfa46615be8c0253fe1">step_forward</a> (<span class="keywordtype">int</span> nt)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ntt=0 ; ntt&lt;nt ; ntt++, t+=dt, ti++)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// printf(&quot;UP TO TIME: %g with timestep: %g\n&quot;, t, dt);</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// printf(&quot;%g %g %g\n&quot;, X[0][0],X[0][1],X[0][2]);</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordtype">bool</span> isdumptime = (ntt==nt-1) || (ti % P.<a class="code" href="classParameters.html#af6fc5ade6489276b4b75b1a8442c7aa7">tdump</a>==0) ;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">//P.display_info(ti, V, Omega, F, Torque, 0, 0) ;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (ti%P.<a class="code" href="classParameters.html#a60886a19fc5cbee4a1f6c7886eb40ec4">tinfo</a>==0)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            tnow = clock();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            printf(<span class="stringliteral">&quot;\r%10g | %5.2g%% | %d iterations in %10gs | %5d | finish in %10gs&quot;</span>,t, t/P.<a class="code" href="classParameters.html#a43c244f24421c088502ad8dd46032e0e">T</a>*100, P.<a class="code" href="classParameters.html#a60886a19fc5cbee4a1f6c7886eb40ec4">tinfo</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <span class="keywordtype">double</span>(tnow - tprevious) / CLOCKS_PER_SEC, ti, ((P.<a class="code" href="classParameters.html#a43c244f24421c088502ad8dd46032e0e">T</a>-t)/(P.<a class="code" href="classParameters.html#a60886a19fc5cbee4a1f6c7886eb40ec4">tinfo</a>*dt))*(<span class="keywordtype">double</span>(tnow - tprevious) / CLOCKS_PER_SEC)) ;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">//fprintf(logfile, &quot;%d %10g %lu %lu\n&quot;, ti, double(tnow - tprevious) / CLOCKS_PER_SEC, MP.CLp[0].v.size(), MP.CLw[0].v.size()) ;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            fflush(stdout) ;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            tprevious=tnow ;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">//----- Velocity Verlet step 1 : compute the new positions</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">        #pragma omp parallel for default(none) shared (N) shared(X) shared(P) shared(V) shared(FOld) shared(Omega) shared(PBCFlags) shared(dt) shared(Ghost) shared(Ghost_dir) shared(A)</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a> ; i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordtype">double</span> disp, totdisp=0 ;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd=0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                disp = V[i][dd]*dt + FOld[i][dd] * (dt * dt / P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[i] /2.) ;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                X[i][dd] += disp  ;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                totdisp += disp*disp ;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">//displacement[i] += sqrt(totdisp) ;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="comment">//if (displacement[i] &gt; maxdisp[0]) {maxdisp[1]=maxdisp[0] ; maxdisp[0]=displacement[i] ; } // ERROR RACE CONDITION ON MAXDISP</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// Simpler version to make A evolve (Euler, doesn&#39;t need to be accurate actually, A is never used for the dynamics), and Gram-Shmidt orthonormalising after ...</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a0a9d02b87e701c2839b40bc1035f594b">orientationtracking</a>)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> tmpO (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0), tmpterm1 (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0) ;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <a class="code" href="group__DEM.html#gabbda5dce569e943409a14e1add6185af">Tools&lt;d&gt;::skewexpand</a>(tmpO, Omega[i]) ;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="group__DEM.html#gab2e10cac5ba35b73fb2408dc4a216d04">Tools&lt;d&gt;::matmult</a>(tmpterm1, tmpO, A[i]) ;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd=0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    A[i][dd] -= tmpterm1[dd] * dt ;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="group__DEM.html#ga1a8e5f27dfca54cbdcebe441dae4d31e">Tools&lt;d&gt;::orthonormalise</a>(A[i]) ;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// Boundary conditions ...</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            P.<a class="code" href="classParameters.html#a9ae045af9cbda9884d98d0f6f885d6cd">perform_PBC</a>(X[i], PBCFlags[i]) ;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            P.<a class="code" href="classParameters.html#a5aa5f13f9621704a454f988a897daf48">perform_PBCLE</a>(X[i], V[i], PBCFlags[i]) ;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="comment">// Find ghosts</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            Ghost[i]=0 ; Ghost_dir[i]=0 ;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            uint32_t mask=1 ;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0 ; j&lt;P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>.size() ; j++, mask&lt;&lt;=1)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">if</span> (!P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].is_periodic()) continue ;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">if</span>      (X[i][j] &lt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].xmin + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {Ghost[i] |= mask ; }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X[i][j] &gt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].xmax - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {Ghost[i] |= mask ; Ghost_dir[i] |= mask ;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3">WallType::PBC_LE</a> &amp;&amp; (Ghost[i]&amp;1)) <span class="comment">// We need to consider the case where we have a ghost through the LE_PBC</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                mask = (1&lt;&lt;30) ; <span class="comment">// WARNING dim 30 will be used for LEPBC!!</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordtype">double</span> tmpyloc = X[i][1] + (Ghost_dir[i]&amp;1?-1:1)*P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].displacement ;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                if (tmpyloc &gt; P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmax) tmpyloc -= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].delta ;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keywordflow">if</span> (tmpyloc &lt; P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmin) tmpyloc += P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].delta ;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">if</span>      (tmpyloc &lt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmin + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {Ghost[i] |= mask ; }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmpyloc &gt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmax - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {Ghost[i] |= mask ; Ghost_dir[i] |= mask ;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a4bd24a92c6e415def37e6260fe9335fe">forceinsphere</a>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                P.<a class="code" href="classParameters.html#a1e42c4447a338f4efa6b0b6734e10ab1">perform_forceinsphere</a>(X[i]) ;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">//Nghosts=Ghosts.size() ;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        } <span class="comment">// END PARALLEL SECTION</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        P.<a class="code" href="classParameters.html#af3ca372fa79aa0db07d332488a05ccf5">perform_MOVINGWALL</a>() ;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        P.<a class="code" href="classParameters.html#a28908058acec9286bed2ffcdf770a61a">perform_PBCLE_move</a>() ;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        std::invoke (P.<a class="code" href="classParameters.html#a1da10af2dce557bb12397cd5c526e10f">update_gravity</a>, &amp;P, dt) ;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a> == <a class="code" href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">ContactStrategies::CELLS</a>) cells.<a class="code" href="classCells.html#a35dcc7c9beddea735c7968a564b4da8f">allocate_to_cells</a>(X) ; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">//  printf(&quot;%g %X %X %X %X\n&quot;, X[1][1] + P.Boundaries[0][5], Ghost[0], Ghost_dir[0], Ghost[1], Ghost_dir[1]) ;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">// ----- Contact detection ------</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a> == <a class="code" href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">ContactStrategies::CELLS</a>) MP.<a class="code" href="classMultiproc.html#a94f58ca4ca4e971589c41343c08fc75b">mergeback_CLp</a>() ; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordtype">double</span> LE_displacement ; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3">WallType::PBC_LE</a>) </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            LE_displacement = P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].displacement ; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            LE_displacement = 0 ; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">        #pragma omp parallel default(none) shared(MP) shared(P) shared(N) shared(X) shared(Ghost) shared(Ghost_dir) shared(RigidBodyId) shared (stdout) shared(cells) shared(LE_displacement)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">         #ifdef NO_OPENMP</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;         <span class="keywordtype">int</span> ID = 0 ;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">         #else</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         <span class="keywordtype">int</span> ID = omp_get_thread_num();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="keywordtype">double</span> timebeg = omp_get_wtime();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">         #endif</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         <a class="code" href="classcpm.html">cpm&lt;d&gt;</a> tmpcpm(0,0,0,0,<span class="keyword">nullptr</span>) ; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         <a class="code" href="classcp.html">cp&lt;d&gt;</a> tmpcp(0,0,0,<span class="keyword">nullptr</span>) ; <span class="keywordtype">double</span> sum=0 ;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;         <a class="code" href="classContactList.html">ContactList&lt;d&gt;</a> &amp; CLw = MP.<a class="code" href="classMultiproc.html#ab2f6b71cfb789957377af15f57c3ddc8">CLw</a>[ID] ; <a class="code" href="classContactListMesh.html">ContactListMesh&lt;d&gt;</a> &amp; CLm = MP.<a class="code" href="classMultiproc.html#a5a9827919c93444b010a9304cfb5660a">CLm</a>[ID] ; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         CLw.<a class="code" href="classContactList.html#ae6b2347737d74ed721eb111c3cee5557">reset</a>(); CLm.<a class="code" href="classContactListMesh.html#a65c45a2d0bf68b072baa0a46edfeac5e">reset</a>() ; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;         <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a> == <a class="code" href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">ContactStrategies::CELLS</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;             cells.<a class="code" href="classCells.html#a800130a1751d96e00576d3baec9aacae">contacts</a>({MP.<a class="code" href="classMultiproc.html#ac94c47a155a14823478427d3257fb381">sharecell</a>[ID], MP.<a class="code" href="classMultiproc.html#ac94c47a155a14823478427d3257fb381">sharecell</a>[ID+1]}, MP.<a class="code" href="classMultiproc.html#ad7e0402a4f8c180d27f4977d57b064b8">CLp_all</a>, MP.<a class="code" href="classMultiproc.html#a8e44ce6bab8e8f03bbc21d2616c651ea">CLp</a>[ID], X, P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>, LE_displacement) ; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="classContactList.html">ContactList&lt;d&gt;</a> &amp; CLp = MP.<a class="code" href="classMultiproc.html#a8e44ce6bab8e8f03bbc21d2616c651ea">CLp</a>[ID] ;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            CLp.<a class="code" href="classContactList.html#ae6b2347737d74ed721eb111c3cee5557">reset</a>() ; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=MP.<a class="code" href="classMultiproc.html#aaca563b2f6dc09eca7082d598265934a">share</a>[ID] ; i&lt;MP.<a class="code" href="classMultiproc.html#aaca563b2f6dc09eca7082d598265934a">share</a>[ID+1] ; i++)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="comment">// Contact detection between particles</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                tmpcp.<a class="code" href="classcp.html#a580937a3a7772290cd7102ebf3f63fa6">setinfo</a>(CLp.<a class="code" href="classContactList.html#acb3cd068eb25c33ac060bbfe0ea8b954">default_action</a>());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                tmpcp.<a class="code" href="classcp.html#a532976de3eaca669595936a9dff36f69">i</a>=i ;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=i+1 ; j&lt;<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a> ; j++) <span class="comment">// Regular particles</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <span class="keywordflow">if</span> (RigidBodyId[i].has_value() &amp;&amp; RigidBodyId[j].has_value() &amp;&amp;  RigidBodyId[i]==RigidBodyId[j]) continue ; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    <span class="keywordflow">if</span> (Ghost[j] | Ghost[i])</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=j ; tmpcp.<a class="code" href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">ghostdir</a>=Ghost_dir[j] | (Ghost[i]&amp;(~Ghost_dir[i])) ;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="group__DEM.html#gab4bc6d35a811dbdd4c1f943a6f679d63">bitdim</a> tmpghost = Ghost[j] | Ghost[i] ;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3">WallType::PBC_LE</a> &amp;&amp; (Ghost[i]&amp;1))</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        {                            </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                            <span class="keywordtype">double</span> tmpyloc = X[j][1] + (tmpcp.<a class="code" href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">ghostdir</a>&amp;1?-1:1)*P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[0].displacement ;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                            if (tmpyloc &gt; P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmax) tmpyloc -= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].delta ;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                            <span class="keywordflow">if</span> (tmpyloc &lt; P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmin) tmpyloc += P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].delta ;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                            <span class="keywordflow">if</span>      (tmpyloc &lt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmin + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {tmpghost |= (1&lt;&lt;30)  ; }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmpyloc &gt;= P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[1].xmax - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) {tmpghost |= (1&lt;&lt;30)  ; tmpcp.<a class="code" href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">ghostdir</a> |= (1&lt;&lt;30)  ;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <span class="comment">//CLp.check_ghost (Ghost[j], P, X[i], X[j], tmpcp) ;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        (CLp.*CLp.<a class="code" href="classContactList.html#a08fdf8ce5fb516bc5f1cd18c088866b6">check_ghost</a>) (tmpghost, P, X[i], X[j], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[j], tmpcp, 0,0,0) ;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        sum=0 ;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; sum&lt;(P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]+P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[j])*(P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]+P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[j]) &amp;&amp; k&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; k++) sum+= (X[i][k]-X[j][k])*(X[i][k]-X[j][k]) ;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <span class="keywordflow">if</span> (sum&lt;(P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]+P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[j])*(P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]+P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[j]))</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=j ; tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>=sqrt(sum) ; tmpcp.<a class="code" href="classcp.html#a5ab3a9afca56ffd7798e9b3c40564dad">ghost</a>=0 ; tmpcp.<a class="code" href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">ghostdir</a>=0 ;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                            CLp.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            CLp.<a class="code" href="classContactList.html#aa82dd18cb5347359b32d54c7dd22181f">finalise</a>() ;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=MP.<a class="code" href="classMultiproc.html#aaca563b2f6dc09eca7082d598265934a">share</a>[ID] ; i&lt;MP.<a class="code" href="classMultiproc.html#aaca563b2f6dc09eca7082d598265934a">share</a>[ID+1] ; i++)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="comment">// Contact detection between particles and walls</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            tmpcp.<a class="code" href="classcp.html#a580937a3a7772290cd7102ebf3f63fa6">setinfo</a>(CLw.<a class="code" href="classContactList.html#acb3cd068eb25c33ac060bbfe0ea8b954">default_action</a>());</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            tmpcp.<a class="code" href="classcp.html#a532976de3eaca669595936a9dff36f69">i</a>=i ; tmpcp.<a class="code" href="classcp.html#a5ab3a9afca56ffd7798e9b3c40564dad">ghost</a>=0 ;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0 ; j&lt;P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>.size() ; j++) <span class="comment">// Wall contacts</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a817a7e6f14396060c4e915adcaefb88e">WallType::PBC</a>) continue ;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a48d536b2de1195d0c9f6ea8ab884085e">WallType::WALL</a> || P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35aec0ee4a392a3223b0d108d177aaa8bd7">WallType::MOVINGWALL</a>)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                        tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>=fabs(X[i][j]-P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].xmin) ;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>&lt;P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=(2*j+0);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                            CLw.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>=fabs(X[i][j]-P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].xmax) ;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>&lt;P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=(2*j+1);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                            CLw.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6f7cea7381e843e2ee0338b4a92b0d43">WallType::SPHERE</a> || </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                             P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a745727a64f32080cf213b668026dde48">WallType::HEMISPHERE</a> || </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                             P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6ef552336b9209dafccffb492dd3a80e">WallType::ROTATINGSPHERE</a>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>=0 ;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd=0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> += (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].center[dd] - X[i][dd])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].center[dd] - X[i][dd]) ;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &lt; (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) &amp;&amp;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &gt; (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]))</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> = sqrt(tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>) - P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius ;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                            <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &lt; 0) tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=2*j;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                            <span class="keywordflow">else</span> tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=2*j+1 ;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> = fabs(tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>) ;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                            CLw.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35acdc57914080484150a75fb5aa18cdb73">WallType::AXIALCYLINDER</a>)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    {                        </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>=0 ;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd=0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                            <span class="keywordflow">if</span> (dd == P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].axis) continue ; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> += (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].center[dd] - X[i][dd])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].center[dd] - X[i][dd]) ;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &lt; (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) &amp;&amp;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &gt; (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius - P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]))</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> = sqrt(tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>) - P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].radius ;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &lt; 0) tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=2*j;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            <span class="keywordflow">else</span> tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=2*j+1 ;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> = fabs(tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>) ;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                            CLw.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a3507764cffdfea213396f9d9eb30f870">WallType::ELLIPSE</a>)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        static_assert((<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)==8)) ;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        <span class="keywordtype">double</span> tparam ; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        std::tie(tparam, tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>) = <a class="code" href="classTools__2D.html#a41814f9d41d72d83138f98caeaeba426">Tools_2D::contact_ellipse_disk</a> (X[i], P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].semiaxisx, P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].semiaxisy, P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].centerx, P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[j].centery, P.<a class="code" href="classParameters.html#a69039841728dad5507f626c4107a96c0">graddesc_gamma</a>, P.<a class="code" href="classParameters.html#adeb462556b370323b119215b80f7f758">graddesc_tol</a>) ; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        <span class="keywordflow">if</span> (tmpcp.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a>&lt;P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i])</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">j</a>=2*j ;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">                            #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">                            #pragma GCC diagnostic ignored &quot;-Wstrict-aliasing&quot;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                            tmpcp.<a class="code" href="classcp.html#a5ab3a9afca56ffd7798e9b3c40564dad">ghost</a> = *(<span class="keyword">reinterpret_cast&lt;</span>uint32_t*<span class="keyword">&gt;</span>(&amp;tparam)) ;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            tmpcp.<a class="code" href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">ghostdir</a>=*(<span class="keyword">reinterpret_cast&lt;</span>uint64_t*<span class="keyword">&gt;</span>(&amp;tparam))&gt;&gt;32 ;      <span class="comment">//ugly bit punning, I&#39;m so sorry...</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">                            #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            CLw.<a class="code" href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">insert</a>(tmpcp) ;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        }                       </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">// Contact detection between particles and meshes</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            tmpcpm.<a class="code" href="classcp.html#a580937a3a7772290cd7102ebf3f63fa6">setinfo</a>(CLm.<a class="code" href="classContactListMesh.html#a30a7d70e9877164829c0979d60e718aa">default_action</a>()) ; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            tmpcpm.<a class="code" href="classcp.html#a532976de3eaca669595936a9dff36f69">i</a>=i ;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0 ; j&lt;P.<a class="code" href="classParameters.html#a9c4645659b35a8d070ae740d4a4db40c">Meshes</a>.size() ; j++) <span class="comment">//TODO Meshes incompatible with PBC</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="keywordtype">bool</span> a= CLm.<a class="code" href="classContactListMesh.html#a2bdbf8640793b796454260b791376ab5">check_mesh_dst_contact</a>(P.<a class="code" href="classParameters.html#a9c4645659b35a8d070ae740d4a4db40c">Meshes</a>[j], X[i], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i], tmpcpm) ;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="comment">//printf(&quot;%d %g %g |&quot;, a, tmpcpm.contactlength, P.skin) ; </span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">if</span> (a &amp;&amp; tmpcpm.<a class="code" href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">contactlength</a> &lt; P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    CLm.<a class="code" href="group__DEM.html#ga9a6ec0e1f8f2f49751587ecde95ac31a">insert</a>(tmpcpm) ; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        CLw.<a class="code" href="classContactList.html#aa82dd18cb5347359b32d54c7dd22181f">finalise</a>() ;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        CLm.<a class="code" href="classContactListMesh.html#adc1ea5fa252640f9d53bf660efbd3536">finalise</a>() ;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">        #ifndef NO_OPENMP</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        MP.<a class="code" href="classMultiproc.html#a2ebc89a0a5bfe1b4817ea8baa4e6802e">timing_contacts</a>[ID] += omp_get_wtime()-timebeg;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        } <span class="comment">//END PARALLEL SECTION</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">//printf(&quot;{%ld %ld}&quot;, MP.CLp_all.v.size(), MP.CLp[0].v.size()) ; fflush(stdout) ; </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a> == <a class="code" href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">ContactStrategies::CELLS</a>) MP.<a class="code" href="classMultiproc.html#a87050aeab8113dc0e1fb28c51e3979b8">merge_split_CLp</a>() ; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">//printf(&quot;\n{%ld}\n&quot;, MP.CLp[0].v.size()) ; </span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">//-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// Force and torque computation</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(F) ; <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(Fcorr) ; <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(TorqueCorr) ;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="group__DEM.html#gad1f0f6cfabfe20decb2e861a2b1fa4e9">Tools&lt;d&gt;::setgravity</a>(F, P.<a class="code" href="classParameters.html#a055d85302bc18778fa0acc33606dc8d1">g</a>, P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>); <span class="comment">// Actually set gravity is effectively also doing the setzero</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(Torque);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = ExternalAction.begin() ; it&lt;ExternalAction.end() ; <span class="comment">/*KEEP EMPTY*/</span> )</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <a class="code" href="classTools.html#a48628bbf3c0db32dd76257ee71bfcb3e">Tools&lt;d&gt;::vAddFew</a>(F[it-&gt;id], it-&gt;Fn, it-&gt;Ft, Fcorr[it-&gt;id]) ;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[it-&gt;id], it-&gt;Torquei, TorqueCorr[it-&gt;id]) ;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            it-&gt;duration -- ;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (it-&gt;duration&lt;=0)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                ExternalAction.erase(it) ;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                it++ ;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">//Particle - particle contacts</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">        #pragma omp parallel default(none) shared(MP) shared(P) shared(X) shared(V) shared(Omega) shared(F) shared(Fcorr) shared(TorqueCorr) shared(Torque) shared(stdout) shared(isdumptime)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">          #ifdef NO_OPENMP</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordtype">int</span> ID = 0 ;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">          #else</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordtype">int</span> ID = omp_get_thread_num();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordtype">double</span> timebeg = omp_get_wtime();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">          #endif</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="classContactList.html">ContactList&lt;d&gt;</a> &amp; CLp = MP.<a class="code" href="classMultiproc.html#a8e44ce6bab8e8f03bbc21d2616c651ea">CLp</a>[ID] ; <a class="code" href="classContactList.html">ContactList&lt;d&gt;</a> &amp; CLw = MP.<a class="code" href="classMultiproc.html#ab2f6b71cfb789957377af15f57c3ddc8">CLw</a>[ID] ; <a class="code" href="classContactListMesh.html">ContactListMesh&lt;d&gt;</a> &amp; CLm = MP.<a class="code" href="classMultiproc.html#a5a9827919c93444b010a9304cfb5660a">CLm</a>[ID] ; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <a class="code" href="classContacts.html">Contacts&lt;d&gt;</a> &amp; C =MP.<a class="code" href="classMultiproc.html#a4e7773b5cad1e6e8034756a456b1bc20">C</a>[ID] ;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> tmpcn (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0) ; <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> tmpvel (<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0) ;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="comment">// Particle-particle contacts</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="comment">//printf(&quot;====%d %g=====\n&quot;, ti, P.Boundaries[0].displacement) ;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = CLp.<a class="code" href="classContactList.html#a75f15cd9b0711158597aed2b162852ce">v</a>.begin() ; it!=CLp.<a class="code" href="classContactList.html#a75f15cd9b0711158597aed2b162852ce">v</a>.end() ; it++)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="comment">//printf(&quot;%d %d %X %X %g\n&quot;, it-&gt;i, it-&gt;j, it-&gt;ghost, it-&gt; ghostdir, it-&gt;contactlength) ; </span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <span class="keywordflow">if</span> (it-&gt;ghost==0)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    C.<a class="code" href="group__DEM.html#ga39feb4da43311f97c104f2c798bca233">particle_particle</a>(X[it-&gt;i], V[it-&gt;i], Omega[it-&gt;i], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i],</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                        X[it-&gt;j], V[it-&gt;j], Omega[it-&gt;j], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;j], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;j], *it, isdumptime) ;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="comment">// printf(&quot;%d\n&quot;, it-&gt;ghost) ; fflush(stdout) ; </span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    (C.*C.<a class="code" href="classContacts.html#a366b8a359b3e20833d9d1c372fb276df">particle_ghost</a>) (X[it-&gt;i], V[it-&gt;i], Omega[it-&gt;i], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i],</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                        X[it-&gt;j], V[it-&gt;j], Omega[it-&gt;j], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;j], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;j], *it, isdumptime);<span class="comment">//, logghosts) ;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keywordflow">if</span> (isdumptime) it-&gt;saveinfo(C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>) ;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <a class="code" href="classTools.html#a48628bbf3c0db32dd76257ee71bfcb3e">Tools&lt;d&gt;::vAddFew</a>(F[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Fn, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Ft, Fcorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Torquei, TorqueCorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="keywordflow">if</span> (MP.<a class="code" href="classMultiproc.html#ac6e431647b8c71303a1f5cfbce4dd7e8">ismine</a>(ID,it-&gt;j))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <a class="code" href="classTools.html#acf8b7c2f6200ca67ea31099cc6612691">Tools&lt;d&gt;::vSubFew</a>(F[it-&gt;j], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Fn, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Ft, Fcorr[it-&gt;j]) ;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[it-&gt;j], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Torquej, TorqueCorr[it-&gt;j]) ;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    MP.<a class="code" href="group__DEM.html#ga09cbf4014b6f64277c0cfd25c1caad11">delaying</a>(ID, it-&gt;j, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>) ;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                it-&gt;persisting = false ; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="comment">//Tools&lt;d&gt;::vAdd(F[it-&gt;i], Act.Fn, Act.Ft) ; Tools&lt;d&gt;::vSub(F[it-&gt;j], Act.Fn, Act.Ft) ; //F[it-&gt;i] += (Act.Fn + Act.Ft) ; F[it-&gt;j] -= (Act.Fn + Act.Ft) ;</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="comment">//Torque[it-&gt;i] += Act.Torquei ; Torque[it-&gt;j] += Act.Torquej ;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="comment">// Particle wall contacts</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = CLw.<a class="code" href="classContactList.html#a75f15cd9b0711158597aed2b162852ce">v</a>.begin() ; it!=CLw.<a class="code" href="classContactList.html#a75f15cd9b0711158597aed2b162852ce">v</a>.end() ; it++)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6f7cea7381e843e2ee0338b4a92b0d43">WallType::SPHERE</a> ||</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a745727a64f32080cf213b668026dde48">WallType::HEMISPHERE</a>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="keywordflow">if</span> ( P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a745727a64f32080cf213b668026dde48">WallType::HEMISPHERE</a> &amp;&amp; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        X[it-&gt;i][P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].axis]&gt;P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].center[P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].axis]+P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i]) continue ; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        tmpcn[dd] = (X[it-&gt;i][dd]-P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].center[dd])*((it-&gt;j%2==0)?-1:1) ;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    tmpcn/=<a class="code" href="group__DEM.html#gafb203c2bc8e3a924956443db4948635d">Tools&lt;d&gt;::norm</a>(tmpcn) ;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    C.<a class="code" href="group__DEM.html#gac63743cf778b36c09f172ec8f1130fe3">particle_wall</a>( V[it-&gt;i],Omega[it-&gt;i],P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], tmpcn, *it) ;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35acdc57914080484150a75fb5aa18cdb73">WallType::AXIALCYLINDER</a>)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    tmpcn[P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].axis]= 0 ; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <span class="keywordflow">if</span> (dd == P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].axis) continue ; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        tmpcn[dd] = (X[it-&gt;i][dd]-P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].center[dd])*((it-&gt;j%2==0)?-1:1) ;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    tmpcn/=<a class="code" href="group__DEM.html#gafb203c2bc8e3a924956443db4948635d">Tools&lt;d&gt;::norm</a>(tmpcn) ;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    C.<a class="code" href="group__DEM.html#gac63743cf778b36c09f172ec8f1130fe3">particle_wall</a>( V[it-&gt;i],Omega[it-&gt;i],P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], tmpcn, *it) ;                    </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6ef552336b9209dafccffb492dd3a80e">WallType::ROTATINGSPHERE</a>)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0 ; dd&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        tmpcn[dd] = (X[it-&gt;i][dd]-P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].center[dd])*((it-&gt;j%2==0)?-1:1) ;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    tmpcn/=<a class="code" href="group__DEM.html#gafb203c2bc8e3a924956443db4948635d">Tools&lt;d&gt;::norm</a>(tmpcn) ;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <a class="code" href="group__DEM.html#gae580a0c4104608d38bc3b07d31a03180">Tools&lt;d&gt;::surfacevelocity</a>(tmpvel, X[it-&gt;i]+tmpcn*(-P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i]), &amp;(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].center[0]) , <span class="keyword">nullptr</span>, &amp;(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].omega[0])) ;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="comment">//printf(&quot;%g | %g %g | %g %g | %g %g\n&quot;, P.Boundaries[it-&gt;j/2][4+2], (X[it-&gt;i]+tmpcn*(-P.r[it-&gt;i]))[0], (X[it-&gt;i]+tmpcn*(-P.r[it-&gt;i]))[1], P.Boundaries[it-&gt;j/2][4], P.Boundaries[it-&gt;j/2][5], tmpvel[0], tmpvel[1]) ; fflush(stdout) ;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    C.<a class="code" href="group__DEM.html#ga5b2f157533a646027c5b6027bf522af2">particle_movingwall</a>(V[it-&gt;i],Omega[it-&gt;i],P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], tmpcn, tmpvel, *it) ;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a3507764cffdfea213396f9d9eb30f870">WallType::ELLIPSE</a>)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    assert((<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>==2)) ; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    std::vector&lt;double&gt; tmpcn(2) ; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="preprocessor">                    #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">                    #pragma GCC diagnostic ignored &quot;-Wstrict-aliasing&quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    uint64_t c=((uint64_t)(it-&gt;ghostdir) &lt;&lt;32 | (uint64_t)(it-&gt;ghost)) ;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    <span class="keywordtype">double</span> tparam = *<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span>*<span class="keyword">&gt;</span>(&amp;c) ; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">                    #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    tmpcn[0]=X[it-&gt;i][0]-(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].centerx+P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].semiaxisx*cos(tparam)) ; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    tmpcn[1]=X[it-&gt;i][1]-(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].centery+P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[it-&gt;j/2].semiaxisy*sin(tparam)) ; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    tmpcn/=sqrt(tmpcn[0]*tmpcn[0]+tmpcn[1]*tmpcn[1]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    C.<a class="code" href="group__DEM.html#gac63743cf778b36c09f172ec8f1130fe3">particle_wall</a>( V[it-&gt;i],Omega[it-&gt;i],P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], tmpcn, *it) ;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    <a class="code" href="group__DEM.html#ga2c16637999a27df000debc5d377fbd1f">Tools&lt;d&gt;::unitvec</a>(tmpcn, it-&gt;j/2) ;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                    tmpcn=tmpcn*(-((it-&gt;j%2==0)?-1:1)) ; <span class="comment">// l give the orientation (+1 or -1)</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                    C.<a class="code" href="group__DEM.html#gac63743cf778b36c09f172ec8f1130fe3">particle_wall</a>( V[it-&gt;i],Omega[it-&gt;i],P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], tmpcn, *it) ;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="comment">//Tools&lt;d&gt;::vAdd(F[it-&gt;i], Act.Fn, Act.Ft) ; // F[it-&gt;i] += (Act.Fn+Act.Ft) ;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                <span class="comment">//Torque[it-&gt;i] += Act.Torquei ;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <a class="code" href="classTools.html#a48628bbf3c0db32dd76257ee71bfcb3e">Tools&lt;d&gt;::vAddFew</a>(F[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Fn, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Ft, Fcorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Torquei, TorqueCorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">if</span> ( P.<a class="code" href="classParameters.html#a50a403a968417aa50f428bdcaf7581de">wallforcecompute</a> || ( P.<a class="code" href="classParameters.html#a66ec2ef259871fe9b3336cfa0211e57f">wallforcerequested</a> &amp;&amp; !P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a> ) ) MP.<a class="code" href="group__DEM.html#gac8eab4d302e80bfdef717daddf7bc194">delayingwall</a>(ID, it-&gt;j, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>) ;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="comment">// Particle mesh contacts</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = CLm.<a class="code" href="classContactListMesh.html#a53bff025acdbed195ed78e05ccee53ad">v</a>.begin() ; it != CLm.<a class="code" href="classContactListMesh.html#a53bff025acdbed195ed78e05ccee53ad">v</a>.end() ; it++)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <span class="comment">//printf(&quot;@ %g | %g %g %g | %d \n&quot;, it-&gt;contactlength, it-&gt;contactpoint[0], it-&gt;contactpoint[1], it-&gt;contactpoint[2], it-&gt;submeshid) ; fflush(stdout) ; </span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                C.<a class="code" href="group__DEM.html#ga576af8fc6304221f79cd88339097208e">particle_mesh</a> ( X[it-&gt;i], V[it-&gt;i], Omega[it-&gt;i], P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[it-&gt;i], P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[it-&gt;i], *it) ;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <a class="code" href="classTools.html#a48628bbf3c0db32dd76257ee71bfcb3e">Tools&lt;d&gt;::vAddFew</a>(F[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Fn, C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Ft, Fcorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[it-&gt;i], C.<a class="code" href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Act</a>.Torquei, TorqueCorr[it-&gt;i]) ;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">            #ifndef NO_OPENMP</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            MP.<a class="code" href="classMultiproc.html#acb16094b961b3b72abaaf6fdc0a37b51">timing_forces</a>[ID] += omp_get_wtime()-timebeg;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        } <span class="comment">//END PARALLEL PART</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">//ParticleForce = calculateParticleForce() ;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">// Finish by sequencially adding the grains that were not owned by the parallel proc when computed</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;MP.<a class="code" href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">P</a> ; i++)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="group__DEM.html#ga69aa29b598b851b0640aa225a9e5d61d">uint</a> j=0 ; j&lt;MP.<a class="code" href="classMultiproc.html#a05b600c1fbe8f458d43716d47c43632a">delayed_size</a>[i] ; j++)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <a class="code" href="classTools.html#acf8b7c2f6200ca67ea31099cc6612691">Tools&lt;d&gt;::vSubFew</a>(F[MP.<a class="code" href="classMultiproc.html#aceac9fea800bcc7589415e716cde5b02">delayedj</a>[i][j]], MP.<a class="code" href="classMultiproc.html#a633287157aa869a2e2fb7e65f0970411">delayed</a>[i][j].Fn, MP.<a class="code" href="classMultiproc.html#a633287157aa869a2e2fb7e65f0970411">delayed</a>[i][j].Ft, Fcorr[MP.<a class="code" href="classMultiproc.html#aceac9fea800bcc7589415e716cde5b02">delayedj</a>[i][j]]) ;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <a class="code" href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools&lt;d&gt;::vAddOne</a>(Torque[MP.<a class="code" href="classMultiproc.html#aceac9fea800bcc7589415e716cde5b02">delayedj</a>[i][j]], MP.<a class="code" href="classMultiproc.html#a633287157aa869a2e2fb7e65f0970411">delayed</a>[i][j].Torquej, TorqueCorr[MP.<a class="code" href="classMultiproc.html#aceac9fea800bcc7589415e716cde5b02">delayedj</a>[i][j]]) ;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        MP.<a class="code" href="group__DEM.html#ga9aa57026cccdc2a995d7dffe1e370e9c">delayed_clean</a>() ;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// Benchmark::stop_clock(&quot;Forces&quot;);</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">//---------- Velocity Verlet step 3 : compute the new velocities</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">// Benchmark::start_clock(&quot;Verlet last&quot;);</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        P.<a class="code" href="classParameters.html#a5978769dfdb3e594fa2f7e72b042968d">RigidBodies</a>.process_forces(V, F, Torque, P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>, P.<a class="code" href="classParameters.html#a055d85302bc18778fa0acc33606dc8d1">g</a>) ;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">        #pragma omp parallel for default(none) shared(N) shared(P) shared(V) shared(Omega) shared(F) shared(FOld) shared(Torque) shared(TorqueOld) shared(dt)</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a> ; i++)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">//printf(&quot;%10g %10g %10g\n%10g %10g %10g\n%10g %10g %10g\n\n&quot;, A[0][0], A[0][1], A[0][2], A[0][3], A[0][4], A[0][5], A[0][6], A[0][7], A[0][8]) ;</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a82fdaa5aaa3d845274989e1395013027">Frozen</a>[i]) {<a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(TorqueOld[i]) ; <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(F[i]) ; <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(FOld[i]) ; <span class="comment">/*Tools&lt;d&gt;::setzero(V[i]) ; */</span> <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(Omega[i]) ; }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="classTools.html#a02008248619a268d886047392c5b6afa">Tools&lt;d&gt;::vAddScaled</a>(V[i], dt/2./P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[i], F[i], FOld[i]) ; <span class="comment">//V[i] += (F[i] + FOld[i])*(dt/2./P.m[i]) ;</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="classTools.html#a02008248619a268d886047392c5b6afa">Tools&lt;d&gt;::vAddScaled</a>(Omega[i], dt/2./P.<a class="code" href="classParameters.html#ae92c9e8442bf6fde91c529c1b929026e">I</a>[i], Torque[i], TorqueOld[i]) ; <span class="comment">// Omega[i] += (Torque[i]+TorqueOld[i])*(dt/2./P.I[i]) ;</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">if</span> ( !P.<a class="code" href="classParameters.html#a82fdaa5aaa3d845274989e1395013027">Frozen</a>[i] &amp;&amp; P.<a class="code" href="classParameters.html#a7f2747aaec0e728e9b02dd90bd5f3f2c">damping</a> &gt; 0.0 ) { </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <a class="code" href="classTools.html#ae1c9d6305ea280d7be9a011056d5f9bc">Tools&lt;d&gt;::vSubScaled</a>(Omega[i], P.<a class="code" href="classParameters.html#a7f2747aaec0e728e9b02dd90bd5f3f2c">damping</a>, Omega[i]) ; <span class="comment">// BENJY - add damping to Omega</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="classTools.html#ae1c9d6305ea280d7be9a011056d5f9bc">Tools&lt;d&gt;::vSubScaled</a>(V[i], P.<a class="code" href="classParameters.html#a7f2747aaec0e728e9b02dd90bd5f3f2c">damping</a>, V[i]) ; <span class="comment">// BENJY - add damping to velocity</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            FOld[i]=F[i] ;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            TorqueOld[i]=Torque[i] ;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        } <span class="comment">// END OF PARALLEL SECTION</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">// Benchmark::stop_clock(&quot;Verlet last&quot;);</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">// Check events</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        P.<a class="code" href="classParameters.html#acf2dfae05ad3ca2e0b4a29f8588c8dd5">check_events</a>(t, X,V,Omega) ;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> ( P.<a class="code" href="classParameters.html#a66ec2ef259871fe9b3336cfa0211e57f">wallforcerequested</a> &amp;&amp; !P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a> )</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(WallForce) ;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;MP.<a class="code" href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">P</a> ; i++)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="group__DEM.html#ga69aa29b598b851b0640aa225a9e5d61d">uint</a> j=0 ; j&lt;MP.<a class="code" href="classMultiproc.html#a4ea378fcbc3be22a2afe8744df23d9db">delayedwall_size</a>[i] ; j++)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;              <a class="code" href="classTools.html">Tools&lt;d&gt;::vSubFew</a>(WallForce[MP.<a class="code" href="classMultiproc.html#aec88aed3142b48dade49aa0daa32037a">delayedwallj</a>[i][j]], MP.<a class="code" href="classMultiproc.html#a531208296bfc8d24619ac6eda7b3797a">delayedwall</a>[i][j].Fn, MP.<a class="code" href="classMultiproc.html#a531208296bfc8d24619ac6eda7b3797a">delayedwall</a>[i][j].Ft) ;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// Output something at some point I guess</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">if</span> (ti % P.<a class="code" href="classParameters.html#af6fc5ade6489276b4b75b1a8442c7aa7">tdump</a>==0)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(Z) ; <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;v: MP.<a class="code" href="classMultiproc.html#a8e44ce6bab8e8f03bbc21d2616c651ea">CLp</a>) v.coordinance(Z) ;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            P.<a class="code" href="classParameters.html#a7602512067d56c3d59925e82cf2211e1">dumphandling</a> (ti, t, X, V, Vmag, A, Omega, OmegaMag, PBCFlags, Z, MP) ;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            std::fill(PBCFlags.begin(), PBCFlags.end(), 0);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a50a403a968417aa50f428bdcaf7581de">wallforcecompute</a>)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;              <span class="keywordtype">char</span> path[5000] ; sprintf(path, <span class="stringliteral">&quot;%s/LogWallForce-%05d.txt&quot;</span>, P.<a class="code" href="classParameters.html#a6fa8922d6670f3cfeaaaa538be2e1c15">Directory</a>.c_str(), ti) ;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;              <a class="code" href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools&lt;d&gt;::setzero</a>(WallForce) ;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;MP.<a class="code" href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">P</a> ; i++)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="group__DEM.html#ga69aa29b598b851b0640aa225a9e5d61d">uint</a> j=0 ; j&lt;MP.<a class="code" href="classMultiproc.html#a4ea378fcbc3be22a2afe8744df23d9db">delayedwall_size</a>[i] ; j++)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                  <a class="code" href="classTools.html">Tools&lt;d&gt;::vSubFew</a>(WallForce[MP.<a class="code" href="classMultiproc.html#aec88aed3142b48dade49aa0daa32037a">delayedwallj</a>[i][j]], MP.<a class="code" href="classMultiproc.html#a531208296bfc8d24619ac6eda7b3797a">delayedwall</a>[i][j].Fn, MP.<a class="code" href="classMultiproc.html#a531208296bfc8d24619ac6eda7b3797a">delayedwall</a>[i][j].Ft) ;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="group__DEM.html#ga5e5d7c09c21dc9823729c0226c55f0c1">Tools&lt;d&gt;::savetxt</a>(path, WallForce, ( <span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="stringliteral">&quot;Force on the various walls&quot;</span>)) ;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="comment">//fprintf(stderr, &quot;%g %g\n&quot;, X[0][0], X[0][1]) ;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#a50a403a968417aa50f428bdcaf7581de">wallforcecompute</a> || P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a>) MP.<a class="code" href="group__DEM.html#ga902604fea6f0f763703abe9d7cd3b9a6">delayedwall_clean</a>() ;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// Load balancing on the procs as needed</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">        #ifndef NO_OPENMP</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        MP.<a class="code" href="classMultiproc.html#ac898635d542458c39f661d2dad616b97">num_time</a>++ ;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">if</span> (MP.<a class="code" href="classMultiproc.html#ac898635d542458c39f661d2dad616b97">num_time</a>&gt;100)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          MP.<a class="code" href="group__DEM.html#ga64473def2a41ed54010b316e8b9f3bf5">load_balance</a>(P.<a class="code" href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">contact_strategy</a>) ;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="comment">// Cleaning the load balancing</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          MP.<a class="code" href="classMultiproc.html#ac898635d542458c39f661d2dad616b97">num_time</a> = 0 ;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          MP.<a class="code" href="classMultiproc.html#a2ebc89a0a5bfe1b4817ea8baa4e6802e">timing_contacts</a> = vector&lt;double&gt;(MP.<a class="code" href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">P</a>,0) ;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          MP.<a class="code" href="classMultiproc.html#acb16094b961b3b72abaaf6fdc0a37b51">timing_forces</a> = vector&lt;double&gt;(MP.<a class="code" href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">P</a>,0) ;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="group__API.html#ga8f4a717588a487f02fd6226b31d31753">  697</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga8f4a717588a487f02fd6226b31d31753">finalise</a> ()</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    P.<a class="code" href="classParameters.html#a6dd32c3bd87ad3d3632195cf98b8043f">finalise</a>() ;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    printf(<span class="stringliteral">&quot;This is the end ...\n&quot;</span>) ;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">//fclose(logfile) ;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="group__API.html#gaffb633e2c2c65ed82490c3e939f2a51b">  706</a></span>&#160;<span class="comment"></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#gaffb633e2c2c65ed82490c3e939f2a51b">getX</a>() { <span class="keywordflow">return</span> X; }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="group__API.html#ga2afe3cf45586975ffff01d466e8f437c">  709</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="group__API.html#ga2afe3cf45586975ffff01d466e8f437c">getRadii</a>() { <span class="keywordflow">return</span> P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>; }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="group__API.html#ga04e90115f462996d131656184e22cd91">  712</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga04e90115f462996d131656184e22cd91">setRadius</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">double</span> <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae4fe62e6806a7eeb5dbb66ab0544f80a">radius</a>) { P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[id] = <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae4fe62e6806a7eeb5dbb66ab0544f80a">radius</a>; } <span class="comment">// NOTE: NOT UPDATING THE MASS!!! THIS IS SUCH A BAD IDEA</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="group__API.html#ga42f68de4b70af6034f0e3430ad18fcde">  715</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga42f68de4b70af6034f0e3430ad18fcde">setMass</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">double</span> <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431afe1b18e2fd39f763316753b044fbdb78">mass</a>) { P.<a class="code" href="classParameters.html#aa7a42fb485748e6170d527440c726205">m</a>[id] = <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431afe1b18e2fd39f763316753b044fbdb78">mass</a>; }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="group__API.html#ga7e57e1686d5ffd88091e2b2fb7420527">  718</a></span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#ga7e57e1686d5ffd88091e2b2fb7420527">getVelocity</a>() { <span class="keywordflow">return</span> V; }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="group__API.html#gaaae3ce9a68b9ac2886c0c6178da987ad">  721</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="group__API.html#gaaae3ce9a68b9ac2886c0c6178da987ad">getRotationRate</a>() { <a class="code" href="group__DEM.html#gafb203c2bc8e3a924956443db4948635d">Tools&lt;d&gt;::norm</a>(OmegaMag, Omega) ; <span class="keywordflow">return</span> OmegaMag; }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="group__API.html#gaa892abc9bf2f4101a63243adb9836f2c">  724</a></span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#gaa892abc9bf2f4101a63243adb9836f2c">getContactForce</a>() </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">auto</span> [_, res] = MP.<a class="code" href="group__DEM.html#ga981c61f50f6836f5e712818fbefcc5f6">contacts2array</a> (<a class="code" href="group__DEM.html#gga513959f26fd4469592593d8e13e8eba1a447abb17e794509db57d5dcb084124ec">ExportData::IDS</a> | <a class="code" href="group__DEM.html#gga513959f26fd4469592593d8e13e8eba1ad9d729a2fc731c33ea1360682d73aad5">ExportData::FN</a>, X, P) ; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">return</span> res; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  </div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="group__API.html#ga1c98c8c77d3667385ed2da1c15fb8ff3">  731</a></span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#ga1c98c8c77d3667385ed2da1c15fb8ff3">getContactInfos</a>(<span class="keywordtype">int</span> flags) </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">auto</span> [_, res] = MP.<a class="code" href="group__DEM.html#ga981c61f50f6836f5e712818fbefcc5f6">contacts2array</a> (<span class="keyword">static_cast&lt;</span><a class="code" href="group__DEM.html#ga513959f26fd4469592593d8e13e8eba1">ExportData</a><span class="keyword">&gt;</span>(flags), X, P) ; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> res; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// /** \brief DEPRECATED Expose the array of contact forces and velocities. \ingroup API */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">/*std::vector&lt;std::vector&lt;double&gt;&gt; calculateParticleForce()</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">  {</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">    std::vector&lt;std::vector&lt;double&gt;&gt; res ;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">    std::vector&lt;double&gt; tmpfrc ;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">    tmpfrc.resize(2+4*d) ;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">    for (size_t i=0 ; i&lt;MP.CLp.size() ; i++)</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">      for (auto it = MP.CLp[i].v.begin() ; it!=MP.CLp[i].v.end() ; it++)</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">      {</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">        if (it-&gt;infos == nullptr) continue ;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">        tmpfrc[0]=it-&gt;i ;</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">        tmpfrc[1]=it-&gt;j ;</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">        for (int j=0 ; j&lt;d ; j++) tmpfrc[2+j]=it-&gt;infos-&gt;Fn[j] ;</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">        for (int j=0 ; j&lt;d ; j++) tmpfrc[2+d+j]=it-&gt;infos-&gt;Ft[j] ;</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">        for (int j=0 ; j&lt;d ; j++) tmpfrc[2+2*d+j]=it-&gt;infos-&gt;vn[j] ;</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">        for (int j=0 ; j&lt;d ; j++) tmpfrc[2+3*d+j]=it-&gt;infos-&gt;vt[j] ;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">        res.push_back(tmpfrc) ;</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">    return res;</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="group__API.html#ga05c66f3e96abab1dde60a1ea6fbad592">  764</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga05c66f3e96abab1dde60a1ea6fbad592">setX</a>(std::vector &lt; std::vector &lt;double&gt; &gt; X_) { X = X_; }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="group__API.html#gaa7fa3499c5a80bc2b1dc36183ba9caf0">  767</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#gaa7fa3499c5a80bc2b1dc36183ba9caf0">setVelocity</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431a717dc19d2859f49af215c07598ba3fe9">vel</a>) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; i++) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          V[id][i] = <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431a717dc19d2859f49af215c07598ba3fe9">vel</a>[i];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="group__API.html#ga0f3dbc7f5d50d71db205a8bb7270a868">  774</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga0f3dbc7f5d50d71db205a8bb7270a868">setAngularVelocity</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae358f8d850aa0de45e1a1996e67d9bc5">omega</a>) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2); i++) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          Omega[id][i] = <a class="code" href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae358f8d850aa0de45e1a1996e67d9bc5">omega</a>[i];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="group__API.html#ga22a205b23e4dd5e9bf2c5687ac91cb14">  782</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga22a205b23e4dd5e9bf2c5687ac91cb14">fixParticle</a>(<span class="keywordtype">int</span> a, <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> loc) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; i++) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          X[a][i] = loc[i];</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          V[a][i] = 0;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2); i++) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          Omega[a][i] = 0;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="group__API.html#ga0eb8934c406d9a1eea3d72142de1cb89">  793</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga0eb8934c406d9a1eea3d72142de1cb89">setFrozen</a>(<span class="keywordtype">int</span> a) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      P.<a class="code" href="classParameters.html#a82fdaa5aaa3d845274989e1395013027">Frozen</a>[a] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="group__API.html#gae92fc2ba0a8d73cf7bc7abd36a917cf1">  798</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="group__API.html#gae92fc2ba0a8d73cf7bc7abd36a917cf1">getTime</a>() { <span class="keywordflow">return</span> t; }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="group__API.html#gac68aababf0ba558de5d808793efb1e6d">  801</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="group__API.html#gac68aababf0ba558de5d808793efb1e6d">getGravityAngle</a>() { <span class="keywordflow">return</span> P.<a class="code" href="classParameters.html#af43121e14122354ec96ec1406b6867c5">gravityrotateangle</a>; }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno"><a class="line" href="group__API.html#ga3129fa33da12f5f4ae4772d35a24284b">  805</a></span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#ga3129fa33da12f5f4ae4772d35a24284b">getOrientation</a>() { <span class="keywordflow">return</span> A; }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="group__API.html#gaa93f4b63400d7d265968d429dba9fdee">  808</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="group__API.html#gaa93f4b63400d7d265968d429dba9fdee">getBoundary</a>(<span class="keywordtype">int</span> a) { <span class="keywordflow">return</span> P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].as_vector(); }</div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="classSimulation.html#af5dbd055f9556c69b982a7f5f1a233d1">  809</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classSimulation.html#af5dbd055f9556c69b982a7f5f1a233d1">setBoundary</a>(<span class="keywordtype">int</span> a, std::vector&lt;double&gt; loc) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].xmin = loc[0]; <span class="comment">// low value</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].xmax = loc[1]; <span class="comment">// high value</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].delta = loc[1] - loc[0]; <span class="comment">// length</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">if</span> ( P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].Type == <a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3">WallType::PBC_LE</a> ) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[a].vel = loc[2];</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="group__API.html#gac40eb65926ec79d05ab86d8f03d65a1e">  819</a></span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code" href="group__API.html#gac40eb65926ec79d05ab86d8f03d65a1e">getWallForce</a>() {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">// std::cout&lt;&lt;P.wallforcerequested&lt;&lt;&quot; &quot;&lt;&lt;P.wallforcecomputed&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      P.<a class="code" href="classParameters.html#a66ec2ef259871fe9b3336cfa0211e57f">wallforcerequested</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> ( P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a> ) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          P.<a class="code" href="classParameters.html#a66ec2ef259871fe9b3336cfa0211e57f">wallforcerequested</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          P.<a class="code" href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">wallforcecomputed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          <span class="keywordflow">return</span> WallForce;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">return</span> empty_array ;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="group__API.html#ga8543818667137a3859f76967f08c73a2">  833</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__API.html#ga8543818667137a3859f76967f08c73a2">setExternalForce</a> (<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> duration, <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a> force)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      printf(<span class="stringliteral">&quot;\nSetting the force: %g %g %g %g\n&quot;</span>, force[0],force[1],force[2],force[3]);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      ExternalAction.resize(ExternalAction.size()+1) ;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      ExternalAction[ExternalAction.size()-1].id = id ;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      ExternalAction[ExternalAction.size()-1].duration = duration ;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      ExternalAction[ExternalAction.size()-1].set(force, <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a>(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>,0), <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a>(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2,0), <a class="code" href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a>(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>*(<a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a>-1)/2,0)) ;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="classSimulation.html#a49c0ea3881c08d52c37992739fd5e71e">  842</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classSimulation.html#a49c0ea3881c08d52c37992739fd5e71e">randomDrop</a>()</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> seed = 5489UL ; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    boost::random::mt19937 rng(seed);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    boost::random::uniform_01&lt;boost::mt19937&gt; rand(rng) ;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a> ; i++)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dd=0 ; dd &lt; <a class="code" href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a> ; dd++)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;           <span class="keywordflow">if</span> (P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[dd].Type==<a class="code" href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a817a7e6f14396060c4e915adcaefb88e">WallType::PBC</a>)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;             X[i][dd] = rand()*P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[dd].delta + P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[dd].xmin ;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;           <span class="keywordflow">else</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;             X[i][dd] = rand()*(P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[dd].delta-2*P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i]) + P.<a class="code" href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Boundaries</a>[dd].xmin + P.<a class="code" href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">r</a>[i] ;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;} ;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">#ifdef EMSCRIPTEN</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">#ifdef USEBINDINGS</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="emscripten__specific_8h.html">emscripten_specific.h</a>&quot;</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="ttc" id="aBoundaries_8h_html"><div class="ttname"><a href="Boundaries_8h.html">Boundaries.h</a></div></div>
<div class="ttc" id="aCells_8h_html"><div class="ttname"><a href="Cells_8h.html">Cells.h</a></div></div>
<div class="ttc" id="aCoarseGraining_2Parameters_8h_html"><div class="ttname"><a href="CoarseGraining_2Parameters_8h.html">Parameters.h</a></div></div>
<div class="ttc" id="aCoarseGraining_2Typedefs_8h_html"><div class="ttname"><a href="CoarseGraining_2Typedefs_8h.html">Typedefs.h</a></div></div>
<div class="ttc" id="aContactList_8h_html"><div class="ttname"><a href="ContactList_8h.html">ContactList.h</a></div></div>
<div class="ttc" id="aContacts_8h_html"><div class="ttname"><a href="Contacts_8h.html">Contacts.h</a></div></div>
<div class="ttc" id="aMultiproc_8h_html"><div class="ttname"><a href="Multiproc_8h.html">Multiproc.h</a></div></div>
<div class="ttc" id="aclassCells_html"><div class="ttname"><a href="classCells.html">Cells</a></div><div class="ttdoc">All the cells making the space, with related function for creating the cell array,...</div><div class="ttdef"><b>Definition:</b> Cells.h:32</div></div>
<div class="ttc" id="aclassCells_html_a35dcc7c9beddea735c7968a564b4da8f"><div class="ttname"><a href="classCells.html#a35dcc7c9beddea735c7968a564b4da8f">Cells::allocate_to_cells</a></div><div class="ttdeci">int allocate_to_cells(std::vector&lt; std::vector&lt; double &gt;&gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> Cells.h:479</div></div>
<div class="ttc" id="aclassCells_html_a800130a1751d96e00576d3baec9aacae"><div class="ttname"><a href="classCells.html#a800130a1751d96e00576d3baec9aacae">Cells::contacts</a></div><div class="ttdeci">int contacts(std::pair&lt; int, int &gt; bounds, ContactList&lt; d &gt; &amp;CLall, ContactList&lt; d &gt; &amp;CLnew, std::vector&lt; std::vector&lt; double &gt;&gt; const &amp;X, std::vector&lt; double &gt; const &amp;r, double LE_displacement)</div><div class="ttdef"><b>Definition:</b> Cells.h:503</div></div>
<div class="ttc" id="aclassCells_html_acf33aa402cddc885c1e41b91f5a4dbd9"><div class="ttname"><a href="classCells.html#acf33aa402cddc885c1e41b91f5a4dbd9">Cells::cells</a></div><div class="ttdeci">std::vector&lt; Cell &gt; cells</div><div class="ttdef"><b>Definition:</b> Cells.h:114</div></div>
<div class="ttc" id="aclassCells_html_af960620aaf7a9db4f08da964ec16db4b"><div class="ttname"><a href="classCells.html#af960620aaf7a9db4f08da964ec16db4b">Cells::init_cells</a></div><div class="ttdeci">int init_cells(std::vector&lt; Boundary&lt; d &gt;&gt; &amp;boundaries, double ds)</div><div class="ttdef"><b>Definition:</b> Cells.h:189</div></div>
<div class="ttc" id="aclassContactListMesh_html"><div class="ttname"><a href="classContactListMesh.html">ContactListMesh</a></div><div class="ttdoc">Handles lists of contacts with meshes.</div><div class="ttdef"><b>Definition:</b> ContactList.h:281</div></div>
<div class="ttc" id="aclassContactListMesh_html_a2bdbf8640793b796454260b791376ab5"><div class="ttname"><a href="classContactListMesh.html#a2bdbf8640793b796454260b791376ab5">ContactListMesh::check_mesh_dst_contact</a></div><div class="ttdeci">bool check_mesh_dst_contact(Mesh&lt; d &gt; &amp;mesh, cv1d &amp;Xo, double r, cpm&lt; d &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> ContactList.h:290</div></div>
<div class="ttc" id="aclassContactListMesh_html_a30a7d70e9877164829c0979d60e718aa"><div class="ttname"><a href="classContactListMesh.html#a30a7d70e9877164829c0979d60e718aa">ContactListMesh::default_action</a></div><div class="ttdeci">Action&lt; d &gt; * default_action()</div><div class="ttdoc">Easy allocation of a default contact to initialise new contacts.</div><div class="ttdef"><b>Definition:</b> ContactList.h:284</div></div>
<div class="ttc" id="aclassContactListMesh_html_a53bff025acdbed195ed78e05ccee53ad"><div class="ttname"><a href="classContactListMesh.html#a53bff025acdbed195ed78e05ccee53ad">ContactListMesh::v</a></div><div class="ttdeci">list&lt; cpm&lt; d &gt; &gt; v</div><div class="ttdef"><b>Definition:</b> ContactList.h:283</div></div>
<div class="ttc" id="aclassContactListMesh_html_a65c45a2d0bf68b072baa0a46edfeac5e"><div class="ttname"><a href="classContactListMesh.html#a65c45a2d0bf68b072baa0a46edfeac5e">ContactListMesh::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Go to the contact list beginning.</div><div class="ttdef"><b>Definition:</b> ContactList.h:285</div></div>
<div class="ttc" id="aclassContactListMesh_html_adc1ea5fa252640f9d53bf660efbd3536"><div class="ttname"><a href="classContactListMesh.html#adc1ea5fa252640f9d53bf660efbd3536">ContactListMesh::finalise</a></div><div class="ttdeci">void finalise()</div><div class="ttdef"><b>Definition:</b> ContactList.h:286</div></div>
<div class="ttc" id="aclassContactList_html"><div class="ttname"><a href="classContactList.html">ContactList</a></div><div class="ttdoc">Handles lists of contacts.</div><div class="ttdef"><b>Definition:</b> ContactList.h:171</div></div>
<div class="ttc" id="aclassContactList_html_a08fdf8ce5fb516bc5f1cd18c088866b6"><div class="ttname"><a href="classContactList.html#a08fdf8ce5fb516bc5f1cd18c088866b6">ContactList::check_ghost</a></div><div class="ttdeci">bool(ContactList::* check_ghost)(bitdim, const Parameters&lt; d &gt; &amp;, cv1d &amp;, cv1d &amp;, double, double, cp&lt; d &gt; &amp;, int startd, double partialsum, bitdim mask)</div><div class="ttdef"><b>Definition:</b> ContactList.h:259</div></div>
<div class="ttc" id="aclassContactList_html_a75f15cd9b0711158597aed2b162852ce"><div class="ttname"><a href="classContactList.html#a75f15cd9b0711158597aed2b162852ce">ContactList::v</a></div><div class="ttdeci">list&lt; cp&lt; d &gt; &gt; v</div><div class="ttdoc">Contains the list of contact.</div><div class="ttdef"><b>Definition:</b> ContactList.h:250</div></div>
<div class="ttc" id="aclassContactList_html_aa82dd18cb5347359b32d54c7dd22181f"><div class="ttname"><a href="classContactList.html#aa82dd18cb5347359b32d54c7dd22181f">ContactList::finalise</a></div><div class="ttdeci">void finalise()</div><div class="ttdoc">Go to the end of the contact list, erasing any remaining contact which opened.</div><div class="ttdef"><b>Definition:</b> ContactList.h:176</div></div>
<div class="ttc" id="aclassContactList_html_acb3cd068eb25c33ac060bbfe0ea8b954"><div class="ttname"><a href="classContactList.html#acb3cd068eb25c33ac060bbfe0ea8b954">ContactList::default_action</a></div><div class="ttdeci">Action&lt; d &gt; * default_action()</div><div class="ttdoc">Easy allocation of a default contact to initialise new contacts.</div><div class="ttdef"><b>Definition:</b> ContactList.h:251</div></div>
<div class="ttc" id="aclassContactList_html_ae6b2347737d74ed721eb111c3cee5557"><div class="ttname"><a href="classContactList.html#ae6b2347737d74ed721eb111c3cee5557">ContactList::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Go to the contact list beginning.</div><div class="ttdef"><b>Definition:</b> ContactList.h:174</div></div>
<div class="ttc" id="aclassContacts_html"><div class="ttname"><a href="classContacts.html">Contacts</a></div><div class="ttdoc">Calculate contact forces.</div><div class="ttdef"><b>Definition:</b> Contacts.h:23</div></div>
<div class="ttc" id="aclassContacts_html_a366b8a359b3e20833d9d1c372fb276df"><div class="ttname"><a href="classContacts.html#a366b8a359b3e20833d9d1c372fb276df">Contacts::particle_ghost</a></div><div class="ttdeci">void(Contacts::* particle_ghost)(cv1d &amp;Xi, cv1d &amp;Vi, cv1d &amp;Omegai, double ri, double mi, cv1d &amp;Xj, cv1d &amp;Vj, cv1d &amp;Omegaj, double rj, double mj, cp&lt; d &gt; &amp;Contact, bool isdumptime)</div><div class="ttdoc">Function pointer to the function to calculate the ghost-to-particle contact forces.</div><div class="ttdef"><b>Definition:</b> Contacts.h:40</div></div>
<div class="ttc" id="aclassContacts_html_add6bfe7fec27e425132a96bd4a49b468"><div class="ttname"><a href="classContacts.html#add6bfe7fec27e425132a96bd4a49b468">Contacts::Act</a></div><div class="ttdeci">Action&lt; d &gt; Act</div><div class="ttdoc">Resulting Action.</div><div class="ttdef"><b>Definition:</b> Contacts.h:129</div></div>
<div class="ttc" id="aclassMultiproc_html"><div class="ttname"><a href="classMultiproc.html">Multiproc</a></div><div class="ttdoc">Manual multiprocessor handling for OpenMP, for max efficiency &amp; avoiding bugs &amp; race conditions,...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:23</div></div>
<div class="ttc" id="aclassMultiproc_html_a05b600c1fbe8f458d43716d47c43632a"><div class="ttname"><a href="classMultiproc.html#a05b600c1fbe8f458d43716d47c43632a">Multiproc::delayed_size</a></div><div class="ttdeci">vector&lt; uint &gt; delayed_size</div><div class="ttdoc">Max length of the delayed vector for each thread. Can grow as needed on call to delaying()</div><div class="ttdef"><b>Definition:</b> Multiproc.h:125</div></div>
<div class="ttc" id="aclassMultiproc_html_a2ebc89a0a5bfe1b4817ea8baa4e6802e"><div class="ttname"><a href="classMultiproc.html#a2ebc89a0a5bfe1b4817ea8baa4e6802e">Multiproc::timing_contacts</a></div><div class="ttdeci">vector&lt; double &gt; timing_contacts</div><div class="ttdef"><b>Definition:</b> Multiproc.h:119</div></div>
<div class="ttc" id="aclassMultiproc_html_a3e2d638fe1f99d1124d90839ffa14285"><div class="ttname"><a href="classMultiproc.html#a3e2d638fe1f99d1124d90839ffa14285">Multiproc::P</a></div><div class="ttdeci">int P</div><div class="ttdoc">Number of threads.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:133</div></div>
<div class="ttc" id="aclassMultiproc_html_a4e7773b5cad1e6e8034756a456b1bc20"><div class="ttname"><a href="classMultiproc.html#a4e7773b5cad1e6e8034756a456b1bc20">Multiproc::C</a></div><div class="ttdeci">vector&lt; Contacts&lt; d &gt; &gt; C</div><div class="ttdoc">Dummy Contacts for independent calculation per processor.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:116</div></div>
<div class="ttc" id="aclassMultiproc_html_a4ea378fcbc3be22a2afe8744df23d9db"><div class="ttname"><a href="classMultiproc.html#a4ea378fcbc3be22a2afe8744df23d9db">Multiproc::delayedwall_size</a></div><div class="ttdeci">vector&lt; uint &gt; delayedwall_size</div><div class="ttdoc">Max length of the delayed wall vector for each thread. Can grow as needed on call to delaying()</div><div class="ttdef"><b>Definition:</b> Multiproc.h:129</div></div>
<div class="ttc" id="aclassMultiproc_html_a531208296bfc8d24619ac6eda7b3797a"><div class="ttname"><a href="classMultiproc.html#a531208296bfc8d24619ac6eda7b3797a">Multiproc::delayedwall</a></div><div class="ttdeci">vector&lt; vector&lt; Action&lt; d &gt; &gt; &gt; delayedwall</div><div class="ttdoc">Records the delayed Action.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:127</div></div>
<div class="ttc" id="aclassMultiproc_html_a5a9827919c93444b010a9304cfb5660a"><div class="ttname"><a href="classMultiproc.html#a5a9827919c93444b010a9304cfb5660a">Multiproc::CLm</a></div><div class="ttdeci">vector&lt; ContactListMesh&lt; d &gt; &gt; CLm</div><div class="ttdoc">ContactList particle-mesh for each processor.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:115</div></div>
<div class="ttc" id="aclassMultiproc_html_a633287157aa869a2e2fb7e65f0970411"><div class="ttname"><a href="classMultiproc.html#a633287157aa869a2e2fb7e65f0970411">Multiproc::delayed</a></div><div class="ttdeci">vector&lt; vector&lt; Action&lt; d &gt; &gt; &gt; delayed</div><div class="ttdoc">Records the delayed Action.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:123</div></div>
<div class="ttc" id="aclassMultiproc_html_a87050aeab8113dc0e1fb28c51e3979b8"><div class="ttname"><a href="classMultiproc.html#a87050aeab8113dc0e1fb28c51e3979b8">Multiproc::merge_split_CLp</a></div><div class="ttdeci">void merge_split_CLp()</div><div class="ttdef"><b>Definition:</b> Multiproc.h:63</div></div>
<div class="ttc" id="aclassMultiproc_html_a8e44ce6bab8e8f03bbc21d2616c651ea"><div class="ttname"><a href="classMultiproc.html#a8e44ce6bab8e8f03bbc21d2616c651ea">Multiproc::CLp</a></div><div class="ttdeci">vector&lt; ContactList&lt; d &gt; &gt; CLp</div><div class="ttdoc">ContactList particle-particle for each processor.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:113</div></div>
<div class="ttc" id="aclassMultiproc_html_a94f58ca4ca4e971589c41343c08fc75b"><div class="ttname"><a href="classMultiproc.html#a94f58ca4ca4e971589c41343c08fc75b">Multiproc::mergeback_CLp</a></div><div class="ttdeci">void mergeback_CLp()</div><div class="ttdef"><b>Definition:</b> Multiproc.h:102</div></div>
<div class="ttc" id="aclassMultiproc_html_aaca563b2f6dc09eca7082d598265934a"><div class="ttname"><a href="classMultiproc.html#aaca563b2f6dc09eca7082d598265934a">Multiproc::share</a></div><div class="ttdeci">vector&lt; int &gt; share</div><div class="ttdoc">Particle share between threads. A thread ID own particles with index between share[ID] and share[ID+1...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:117</div></div>
<div class="ttc" id="aclassMultiproc_html_ab2f6b71cfb789957377af15f57c3ddc8"><div class="ttname"><a href="classMultiproc.html#ab2f6b71cfb789957377af15f57c3ddc8">Multiproc::CLw</a></div><div class="ttdeci">vector&lt; ContactList&lt; d &gt; &gt; CLw</div><div class="ttdoc">ContactList particle-wall for each processor.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:114</div></div>
<div class="ttc" id="aclassMultiproc_html_ac6e431647b8c71303a1f5cfbce4dd7e8"><div class="ttname"><a href="classMultiproc.html#ac6e431647b8c71303a1f5cfbce4dd7e8">Multiproc::ismine</a></div><div class="ttdeci">bool ismine(int ID, int j)</div><div class="ttdoc">Check if a particle j belongs to the thread ID.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:49</div></div>
<div class="ttc" id="aclassMultiproc_html_ac898635d542458c39f661d2dad616b97"><div class="ttname"><a href="classMultiproc.html#ac898635d542458c39f661d2dad616b97">Multiproc::num_time</a></div><div class="ttdeci">int num_time</div><div class="ttdoc">Number of sample of time spent. Resets when load_balance() is called.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:120</div></div>
<div class="ttc" id="aclassMultiproc_html_ac94c47a155a14823478427d3257fb381"><div class="ttname"><a href="classMultiproc.html#ac94c47a155a14823478427d3257fb381">Multiproc::sharecell</a></div><div class="ttdeci">vector&lt; int &gt; sharecell</div><div class="ttdoc">Cell share between threads (for contact detection based on cells). A thread ID own cells with index b...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:118</div></div>
<div class="ttc" id="aclassMultiproc_html_acb16094b961b3b72abaaf6fdc0a37b51"><div class="ttname"><a href="classMultiproc.html#acb16094b961b3b72abaaf6fdc0a37b51">Multiproc::timing_forces</a></div><div class="ttdeci">vector&lt; double &gt; timing_forces</div><div class="ttdoc">Used to record the time spent by each thread.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:119</div></div>
<div class="ttc" id="aclassMultiproc_html_aceac9fea800bcc7589415e716cde5b02"><div class="ttname"><a href="classMultiproc.html#aceac9fea800bcc7589415e716cde5b02">Multiproc::delayedj</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; delayedj</div><div class="ttdoc">Records the j id of the particle in the associated delayed action.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:124</div></div>
<div class="ttc" id="aclassMultiproc_html_ad7e0402a4f8c180d27f4977d57b064b8"><div class="ttname"><a href="classMultiproc.html#ad7e0402a4f8c180d27f4977d57b064b8">Multiproc::CLp_all</a></div><div class="ttdeci">ContactList&lt; d &gt; CLp_all</div><div class="ttdoc">Full contact list merged for all processor (to go from per cell CLp lists to globally atom sorted,...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:112</div></div>
<div class="ttc" id="aclassMultiproc_html_aec88aed3142b48dade49aa0daa32037a"><div class="ttname"><a href="classMultiproc.html#aec88aed3142b48dade49aa0daa32037a">Multiproc::delayedwallj</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; delayedwallj</div><div class="ttdoc">Records the j id of the wall in the associated delayed action.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:128</div></div>
<div class="ttc" id="aclassMultiproc_html_af469cf9d0075a8d76d22de5980b8602f"><div class="ttname"><a href="classMultiproc.html#af469cf9d0075a8d76d22de5980b8602f">Multiproc::initialise</a></div><div class="ttdeci">void initialise(int NN, int PP, Parameters&lt; d &gt; &amp;Param)</div><div class="ttdef"><b>Definition:</b> Multiproc.h:26</div></div>
<div class="ttc" id="aclassParameters_html"><div class="ttname"><a href="classParameters.html">Parameters</a></div><div class="ttdoc">Generic class to handle the simulation set up.</div><div class="ttdef"><b>Definition:</b> Parameters.h:119</div></div>
<div class="ttc" id="aclassParameters_html_a02221dc8a18e76c8cb1a9f6a1cce159f"><div class="ttname"><a href="classParameters.html#a02221dc8a18e76c8cb1a9f6a1cce159f">Parameters::contact_strategy</a></div><div class="ttdeci">ContactStrategies contact_strategy</div><div class="ttdoc">Strategy for the contact detection.</div><div class="ttdef"><b>Definition:</b> Parameters.h:179</div></div>
<div class="ttc" id="aclassParameters_html_a055d85302bc18778fa0acc33606dc8d1"><div class="ttname"><a href="classParameters.html#a055d85302bc18778fa0acc33606dc8d1">Parameters::g</a></div><div class="ttdeci">vector&lt; double &gt; g</div><div class="ttdoc">Gravity vector.</div><div class="ttdef"><b>Definition:</b> Parameters.h:186</div></div>
<div class="ttc" id="aclassParameters_html_a0a9d02b87e701c2839b40bc1035f594b"><div class="ttname"><a href="classParameters.html#a0a9d02b87e701c2839b40bc1035f594b">Parameters::orientationtracking</a></div><div class="ttdeci">bool orientationtracking</div><div class="ttdoc">Track orientation?</div><div class="ttdef"><b>Definition:</b> Parameters.h:190</div></div>
<div class="ttc" id="aclassParameters_html_a0c27d0ee94ac521382bfbe4b2f9513b6"><div class="ttname"><a href="classParameters.html#a0c27d0ee94ac521382bfbe4b2f9513b6">Parameters::load_datafile</a></div><div class="ttdeci">void load_datafile(char path[], v2d &amp;X, v2d &amp;V, v2d &amp;Omega)</div><div class="ttdoc">Load and parse input script.</div><div class="ttdef"><b>Definition:</b> Parameters.h:486</div></div>
<div class="ttc" id="aclassParameters_html_a1b92dd8955440c8d8f836bb1bc3dfc19"><div class="ttname"><a href="classParameters.html#a1b92dd8955440c8d8f836bb1bc3dfc19">Parameters::xmlout</a></div><div class="ttdeci">XMLWriter * xmlout</div><div class="ttdef"><b>Definition:</b> Parameters.h:350</div></div>
<div class="ttc" id="aclassParameters_html_a1da10af2dce557bb12397cd5c526e10f"><div class="ttname"><a href="classParameters.html#a1da10af2dce557bb12397cd5c526e10f">Parameters::update_gravity</a></div><div class="ttdeci">void(Parameters::* update_gravity)(double time)</div><div class="ttdef"><b>Definition:</b> Parameters.h:244</div></div>
<div class="ttc" id="aclassParameters_html_a1e42c4447a338f4efa6b0b6734e10ab1"><div class="ttname"><a href="classParameters.html#a1e42c4447a338f4efa6b0b6734e10ab1">Parameters::perform_forceinsphere</a></div><div class="ttdeci">bool perform_forceinsphere(v1d &amp;X)</div><div class="ttdef"><b>Definition:</b> Parameters.h:210</div></div>
<div class="ttc" id="aclassParameters_html_a28908058acec9286bed2ffcdf770a61a"><div class="ttname"><a href="classParameters.html#a28908058acec9286bed2ffcdf770a61a">Parameters::perform_PBCLE_move</a></div><div class="ttdeci">void perform_PBCLE_move()</div><div class="ttdef"><b>Definition:</b> Parameters.h:427</div></div>
<div class="ttc" id="aclassParameters_html_a43c244f24421c088502ad8dd46032e0e"><div class="ttname"><a href="classParameters.html#a43c244f24421c088502ad8dd46032e0e">Parameters::T</a></div><div class="ttdeci">double T</div><div class="ttdoc">Run until this time (note it is a floating point).</div><div class="ttdef"><b>Definition:</b> Parameters.h:166</div></div>
<div class="ttc" id="aclassParameters_html_a4bd24a92c6e415def37e6260fe9335fe"><div class="ttname"><a href="classParameters.html#a4bd24a92c6e415def37e6260fe9335fe">Parameters::forceinsphere</a></div><div class="ttdeci">bool forceinsphere</div><div class="ttdef"><b>Definition:</b> Parameters.h:176</div></div>
<div class="ttc" id="aclassParameters_html_a50a403a968417aa50f428bdcaf7581de"><div class="ttname"><a href="classParameters.html#a50a403a968417aa50f428bdcaf7581de">Parameters::wallforcecompute</a></div><div class="ttdeci">bool wallforcecompute</div><div class="ttdoc">Compute for on the wall?</div><div class="ttdef"><b>Definition:</b> Parameters.h:191</div></div>
<div class="ttc" id="aclassParameters_html_a52c6d1cd8b99b54cb39761fb17b33b53"><div class="ttname"><a href="classParameters.html#a52c6d1cd8b99b54cb39761fb17b33b53">Parameters::r</a></div><div class="ttdeci">vector&lt; double &gt; r</div><div class="ttdoc">Particle radii.</div><div class="ttdef"><b>Definition:</b> Parameters.h:183</div></div>
<div class="ttc" id="aclassParameters_html_a578a6da9fd91e0154574903f750440f9"><div class="ttname"><a href="classParameters.html#a578a6da9fd91e0154574903f750440f9">Parameters::N</a></div><div class="ttdeci">int N</div><div class="ttdoc">Number of particles.</div><div class="ttdef"><b>Definition:</b> Parameters.h:163</div></div>
<div class="ttc" id="aclassParameters_html_a5978769dfdb3e594fa2f7e72b042968d"><div class="ttname"><a href="classParameters.html#a5978769dfdb3e594fa2f7e72b042968d">Parameters::RigidBodies</a></div><div class="ttdeci">RigidBodies_&lt; d &gt; RigidBodies</div><div class="ttdoc">Handle all the rigid bodies.</div><div class="ttdef"><b>Definition:</b> Parameters.h:198</div></div>
<div class="ttc" id="aclassParameters_html_a5aa5f13f9621704a454f988a897daf48"><div class="ttname"><a href="classParameters.html#a5aa5f13f9621704a454f988a897daf48">Parameters::perform_PBCLE</a></div><div class="ttdeci">void perform_PBCLE(v1d &amp;X, v1d &amp;V, uint32_t &amp;PBCFlag)</div><div class="ttdef"><b>Definition:</b> Parameters.h:404</div></div>
<div class="ttc" id="aclassParameters_html_a60886a19fc5cbee4a1f6c7886eb40ec4"><div class="ttname"><a href="classParameters.html#a60886a19fc5cbee4a1f6c7886eb40ec4">Parameters::tinfo</a></div><div class="ttdeci">int tinfo</div><div class="ttdoc">Show detail information on scren every this many timesteps.</div><div class="ttdef"><b>Definition:</b> Parameters.h:165</div></div>
<div class="ttc" id="aclassParameters_html_a66ec2ef259871fe9b3336cfa0211e57f"><div class="ttname"><a href="classParameters.html#a66ec2ef259871fe9b3336cfa0211e57f">Parameters::wallforcerequested</a></div><div class="ttdeci">bool wallforcerequested</div><div class="ttdoc">Compute for on the wall?</div><div class="ttdef"><b>Definition:</b> Parameters.h:192</div></div>
<div class="ttc" id="aclassParameters_html_a69039841728dad5507f626c4107a96c0"><div class="ttname"><a href="classParameters.html#a69039841728dad5507f626c4107a96c0">Parameters::graddesc_gamma</a></div><div class="ttdeci">double graddesc_gamma</div><div class="ttdoc">Decay rate parameters for the gradient descent algorithm.</div><div class="ttdef"><b>Definition:</b> Parameters.h:194</div></div>
<div class="ttc" id="aclassParameters_html_a6dd32c3bd87ad3d3632195cf98b8043f"><div class="ttname"><a href="classParameters.html#a6dd32c3bd87ad3d3632195cf98b8043f">Parameters::finalise</a></div><div class="ttdeci">void finalise()</div><div class="ttdoc">Close opened dump files.</div><div class="ttdef"><b>Definition:</b> Parameters.h:1198</div></div>
<div class="ttc" id="aclassParameters_html_a6fa8922d6670f3cfeaaaa538be2e1c15"><div class="ttname"><a href="classParameters.html#a6fa8922d6670f3cfeaaaa538be2e1c15">Parameters::Directory</a></div><div class="ttdeci">string Directory</div><div class="ttdoc">Saving directory.</div><div class="ttdef"><b>Definition:</b> Parameters.h:189</div></div>
<div class="ttc" id="aclassParameters_html_a7602512067d56c3d59925e82cf2211e1"><div class="ttname"><a href="classParameters.html#a7602512067d56c3d59925e82cf2211e1">Parameters::dumphandling</a></div><div class="ttdeci">int dumphandling(int ti, double t, v2d &amp;X, v2d &amp;V, v1d &amp;Vmag, v2d &amp;A, v2d &amp;Omega, v1d &amp;OmegaMag, vector&lt; uint32_t &gt; &amp;PBCFlags, v1d &amp;Z, Multiproc&lt; d &gt; &amp;MP)</div><div class="ttdoc">Dump writing functions.</div><div class="ttdef"><b>Definition:</b> Parameters.h:1208</div></div>
<div class="ttc" id="aclassParameters_html_a7d880b12e436cfb1d597d8a946ec1738"><div class="ttname"><a href="classParameters.html#a7d880b12e436cfb1d597d8a946ec1738">Parameters::set_boundaries</a></div><div class="ttdeci">int set_boundaries()</div><div class="ttdoc">Set default boundaries.</div><div class="ttdef"><b>Definition:</b> Parameters.h:377</div></div>
<div class="ttc" id="aclassParameters_html_a7f2747aaec0e728e9b02dd90bd5f3f2c"><div class="ttname"><a href="classParameters.html#a7f2747aaec0e728e9b02dd90bd5f3f2c">Parameters::damping</a></div><div class="ttdeci">double damping</div><div class="ttdef"><b>Definition:</b> Parameters.h:175</div></div>
<div class="ttc" id="aclassParameters_html_a82fdaa5aaa3d845274989e1395013027"><div class="ttname"><a href="classParameters.html#a82fdaa5aaa3d845274989e1395013027">Parameters::Frozen</a></div><div class="ttdeci">vector&lt; bool &gt; Frozen</div><div class="ttdoc">Frozen atom if true.</div><div class="ttdef"><b>Definition:</b> Parameters.h:187</div></div>
<div class="ttc" id="aclassParameters_html_a980a4800c7649a3b227bba551a53621d"><div class="ttname"><a href="classParameters.html#a980a4800c7649a3b227bba551a53621d">Parameters::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">timestep</div><div class="ttdef"><b>Definition:</b> Parameters.h:167</div></div>
<div class="ttc" id="aclassParameters_html_a9ae045af9cbda9884d98d0f6f885d6cd"><div class="ttname"><a href="classParameters.html#a9ae045af9cbda9884d98d0f6f885d6cd">Parameters::perform_PBC</a></div><div class="ttdeci">void perform_PBC(v1d &amp;X, uint32_t &amp;PBCFlags)</div><div class="ttdoc">Bring particle back in the simulation box if the grains cross the boundaries.</div><div class="ttdef"><b>Definition:</b> Parameters.h:391</div></div>
<div class="ttc" id="aclassParameters_html_a9c4645659b35a8d070ae740d4a4db40c"><div class="ttname"><a href="classParameters.html#a9c4645659b35a8d070ae740d4a4db40c">Parameters::Meshes</a></div><div class="ttdeci">vector&lt; Mesh&lt; d &gt; &gt; Meshes</div><div class="ttdef"><b>Definition:</b> Parameters.h:199</div></div>
<div class="ttc" id="aclassParameters_html_aa7a42fb485748e6170d527440c726205"><div class="ttname"><a href="classParameters.html#aa7a42fb485748e6170d527440c726205">Parameters::m</a></div><div class="ttdeci">vector&lt; double &gt; m</div><div class="ttdoc">Particle mass.</div><div class="ttdef"><b>Definition:</b> Parameters.h:184</div></div>
<div class="ttc" id="aclassParameters_html_aaab9f999922f58587ee5a5a3aec7f42c"><div class="ttname"><a href="classParameters.html#aaab9f999922f58587ee5a5a3aec7f42c">Parameters::cellsize</a></div><div class="ttdeci">double cellsize</div><div class="ttdoc">Size of cells for contact detection.</div><div class="ttdef"><b>Definition:</b> Parameters.h:177</div></div>
<div class="ttc" id="aclassParameters_html_abb8243e1ec09c98643de90d61f051e68"><div class="ttname"><a href="classParameters.html#abb8243e1ec09c98643de90d61f051e68">Parameters::Boundaries</a></div><div class="ttdeci">vector&lt; Boundary&lt; d &gt; &gt; Boundaries</div><div class="ttdoc">List of boundaries. Second dimension is {min, max, length, type}.</div><div class="ttdef"><b>Definition:</b> Parameters.h:188</div></div>
<div class="ttc" id="aclassParameters_html_acf2dfae05ad3ca2e0b4a29f8588c8dd5"><div class="ttname"><a href="classParameters.html#acf2dfae05ad3ca2e0b4a29f8588c8dd5">Parameters::check_events</a></div><div class="ttdeci">void check_events(float time, v2d &amp;X, v2d &amp;V, v2d &amp;Omega)</div><div class="ttdoc">Verify if an event triggers at the current time time.</div><div class="ttdef"><b>Definition:</b> Parameters.h:510</div></div>
<div class="ttc" id="aclassParameters_html_ad631e4d71f90aac5f32768e2c42d2bbd"><div class="ttname"><a href="classParameters.html#ad631e4d71f90aac5f32768e2c42d2bbd">Parameters::wallforcecomputed</a></div><div class="ttdeci">bool wallforcecomputed</div><div class="ttdoc">Compute for on the wall?</div><div class="ttdef"><b>Definition:</b> Parameters.h:193</div></div>
<div class="ttc" id="aclassParameters_html_ade324b0055d861d22b1158c90716a9e3"><div class="ttname"><a href="classParameters.html#ade324b0055d861d22b1158c90716a9e3">Parameters::interpret_command</a></div><div class="ttdeci">void interpret_command(istream &amp;in, v2d &amp;X, v2d &amp;V, v2d &amp;Omega)</div><div class="ttdoc">Parse input script commands.</div><div class="ttdef"><b>Definition:</b> Parameters.h:540</div></div>
<div class="ttc" id="aclassParameters_html_adeb462556b370323b119215b80f7f758"><div class="ttname"><a href="classParameters.html#adeb462556b370323b119215b80f7f758">Parameters::graddesc_tol</a></div><div class="ttdeci">double graddesc_tol</div><div class="ttdoc">Tolerance for the gradient descent algorithm.</div><div class="ttdef"><b>Definition:</b> Parameters.h:195</div></div>
<div class="ttc" id="aclassParameters_html_ae92c9e8442bf6fde91c529c1b929026e"><div class="ttname"><a href="classParameters.html#ae92c9e8442bf6fde91c529c1b929026e">Parameters::I</a></div><div class="ttdeci">vector&lt; double &gt; I</div><div class="ttdoc">Particule moment of inertia.</div><div class="ttdef"><b>Definition:</b> Parameters.h:185</div></div>
<div class="ttc" id="aclassParameters_html_ae9dea3a3136542135ae052ff207f2aeb"><div class="ttname"><a href="classParameters.html#ae9dea3a3136542135ae052ff207f2aeb">Parameters::dumps</a></div><div class="ttdeci">vector&lt; std::pair&lt; ExportType, ExportData &gt; &gt; dumps</div><div class="ttdoc">Vector linking dump file and data dumped.</div><div class="ttdef"><b>Definition:</b> Parameters.h:180</div></div>
<div class="ttc" id="aclassParameters_html_af3ca372fa79aa0db07d332488a05ccf5"><div class="ttname"><a href="classParameters.html#af3ca372fa79aa0db07d332488a05ccf5">Parameters::perform_MOVINGWALL</a></div><div class="ttdeci">void perform_MOVINGWALL()</div><div class="ttdoc">Move the boundary wall if moving.</div><div class="ttdef"><b>Definition:</b> Parameters.h:438</div></div>
<div class="ttc" id="aclassParameters_html_af43121e14122354ec96ec1406b6867c5"><div class="ttname"><a href="classParameters.html#af43121e14122354ec96ec1406b6867c5">Parameters::gravityrotateangle</a></div><div class="ttdeci">double gravityrotateangle</div><div class="ttdef"><b>Definition:</b> Parameters.h:200</div></div>
<div class="ttc" id="aclassParameters_html_af6fc5ade6489276b4b75b1a8442c7aa7"><div class="ttname"><a href="classParameters.html#af6fc5ade6489276b4b75b1a8442c7aa7">Parameters::tdump</a></div><div class="ttdeci">int tdump</div><div class="ttdoc">Write dump file every this many timesteps.</div><div class="ttdef"><b>Definition:</b> Parameters.h:164</div></div>
<div class="ttc" id="aclassSimulation_html"><div class="ttname"><a href="classSimulation.html">Simulation</a></div><div class="ttdef"><b>Definition:</b> DEMND.h:57</div></div>
<div class="ttc" id="aclassSimulation_html_a025db6580b4b23035d281c6ab3179eb8"><div class="ttname"><a href="classSimulation.html#a025db6580b4b23035d281c6ab3179eb8">Simulation::Ghost_dir</a></div><div class="ttdeci">vector&lt; uint32_t &gt; Ghost_dir</div><div class="ttdef"><b>Definition:</b> DEMND.h:85</div></div>
<div class="ttc" id="aclassSimulation_html_a09004b85cc83d2530259200377be3ac7"><div class="ttname"><a href="classSimulation.html#a09004b85cc83d2530259200377be3ac7">Simulation::FOld</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; FOld</div><div class="ttdef"><b>Definition:</b> DEMND.h:66</div></div>
<div class="ttc" id="aclassSimulation_html_a0bfd8350d84ab9a69ec19742836b3c83"><div class="ttname"><a href="classSimulation.html#a0bfd8350d84ab9a69ec19742836b3c83">Simulation::N</a></div><div class="ttdeci">int N</div><div class="ttdef"><b>Definition:</b> DEMND.h:60</div></div>
<div class="ttc" id="aclassSimulation_html_a0c8affa1326621a579c5f73a0c09a62d"><div class="ttname"><a href="classSimulation.html#a0c8affa1326621a579c5f73a0c09a62d">Simulation::Vmag</a></div><div class="ttdeci">std::vector&lt; double &gt; Vmag</div><div class="ttdef"><b>Definition:</b> DEMND.h:69</div></div>
<div class="ttc" id="aclassSimulation_html_a0cdc83ac25525f2908926f6d2ea54ebe"><div class="ttname"><a href="classSimulation.html#a0cdc83ac25525f2908926f6d2ea54ebe">Simulation::Atmp</a></div><div class="ttdeci">v1d Atmp</div><div class="ttdef"><b>Definition:</b> DEMND.h:86</div></div>
<div class="ttc" id="aclassSimulation_html_a1261b3ec74221189cfd15079182f6246"><div class="ttname"><a href="classSimulation.html#a1261b3ec74221189cfd15079182f6246">Simulation::Fcorr</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Fcorr</div><div class="ttdef"><b>Definition:</b> DEMND.h:72</div></div>
<div class="ttc" id="aclassSimulation_html_a1866609acd84ffa7f64127921ea40316"><div class="ttname"><a href="classSimulation.html#a1866609acd84ffa7f64127921ea40316">Simulation::cells</a></div><div class="ttdeci">Cells&lt; d &gt; cells</div><div class="ttdef"><b>Definition:</b> DEMND.h:90</div></div>
<div class="ttc" id="aclassSimulation_html_a191c30360dc18bfcb50414f65837e803"><div class="ttname"><a href="classSimulation.html#a191c30360dc18bfcb50414f65837e803">Simulation::V</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; V</div><div class="ttdef"><b>Definition:</b> DEMND.h:62</div></div>
<div class="ttc" id="aclassSimulation_html_a26d5c37e220b5f586552bc1aa2b44adb"><div class="ttname"><a href="classSimulation.html#a26d5c37e220b5f586552bc1aa2b44adb">Simulation::A</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; A</div><div class="ttdef"><b>Definition:</b> DEMND.h:63</div></div>
<div class="ttc" id="aclassSimulation_html_a2fe4bca258c4a054990e32ba791d7d00"><div class="ttname"><a href="classSimulation.html#a2fe4bca258c4a054990e32ba791d7d00">Simulation::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> DEMND.h:93</div></div>
<div class="ttc" id="aclassSimulation_html_a38838d855fb6de256fc59825e0f72520"><div class="ttname"><a href="classSimulation.html#a38838d855fb6de256fc59825e0f72520">Simulation::MP</a></div><div class="ttdeci">Multiproc&lt; d &gt; MP</div><div class="ttdef"><b>Definition:</b> DEMND.h:89</div></div>
<div class="ttc" id="aclassSimulation_html_a46542e885c635e3ea22a50ef9d36f81a"><div class="ttname"><a href="classSimulation.html#a46542e885c635e3ea22a50ef9d36f81a">Simulation::Torque</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Torque</div><div class="ttdef"><b>Definition:</b> DEMND.h:67</div></div>
<div class="ttc" id="aclassSimulation_html_a47f7361b016f2ff32e4b26741af0616e"><div class="ttname"><a href="classSimulation.html#a47f7361b016f2ff32e4b26741af0616e">Simulation::ParticleForce</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParticleForce</div><div class="ttdef"><b>Definition:</b> DEMND.h:82</div></div>
<div class="ttc" id="aclassSimulation_html_a486ae99dfeb707ec8b1a29e02b754222"><div class="ttname"><a href="classSimulation.html#a486ae99dfeb707ec8b1a29e02b754222">Simulation::PBCFlags</a></div><div class="ttdeci">std::vector&lt; uint32_t &gt; PBCFlags</div><div class="ttdef"><b>Definition:</b> DEMND.h:79</div></div>
<div class="ttc" id="aclassSimulation_html_a49c0ea3881c08d52c37992739fd5e71e"><div class="ttname"><a href="classSimulation.html#a49c0ea3881c08d52c37992739fd5e71e">Simulation::randomDrop</a></div><div class="ttdeci">void randomDrop()</div><div class="ttdef"><b>Definition:</b> DEMND.h:842</div></div>
<div class="ttc" id="aclassSimulation_html_a4aa574e603c9a9013d4663a51cc53df7"><div class="ttname"><a href="classSimulation.html#a4aa574e603c9a9013d4663a51cc53df7">Simulation::init_from_file</a></div><div class="ttdeci">void init_from_file(char filename[])</div><div class="ttdoc">Initialise the simulation from a file.</div><div class="ttdef"><b>Definition:</b> DEMND.h:136</div></div>
<div class="ttc" id="aclassSimulation_html_a4baeea0b400f3894c7d42791a7f75328"><div class="ttname"><a href="classSimulation.html#a4baeea0b400f3894c7d42791a7f75328">Simulation::Z</a></div><div class="ttdeci">std::vector&lt; double &gt; Z</div><div class="ttdef"><b>Definition:</b> DEMND.h:71</div></div>
<div class="ttc" id="aclassSimulation_html_a4dc8ed0a8598f6ba5242f05ec207a205"><div class="ttname"><a href="classSimulation.html#a4dc8ed0a8598f6ba5242f05ec207a205">Simulation::ExternalAction</a></div><div class="ttdeci">std::vector&lt; SpecificAction&lt; d &gt; &gt; ExternalAction</div><div class="ttdef"><b>Definition:</b> DEMND.h:77</div></div>
<div class="ttc" id="aclassSimulation_html_a5fc027c6f24f5b846a0567ca7fc2d19a"><div class="ttname"><a href="classSimulation.html#a5fc027c6f24f5b846a0567ca7fc2d19a">Simulation::RigidBodyId</a></div><div class="ttdeci">std::vector&lt; std::optional&lt; int &gt; &gt; RigidBodyId</div><div class="ttdef"><b>Definition:</b> DEMND.h:75</div></div>
<div class="ttc" id="aclassSimulation_html_a85783d8fe6508bc90f4455f69c65ceee"><div class="ttname"><a href="classSimulation.html#a85783d8fe6508bc90f4455f69c65ceee">Simulation::Simulation</a></div><div class="ttdeci">Simulation(int NN)</div><div class="ttdef"><b>Definition:</b> DEMND.h:97</div></div>
<div class="ttc" id="aclassSimulation_html_a8d3c309593a4596780564b62e86cb594"><div class="ttname"><a href="classSimulation.html#a8d3c309593a4596780564b62e86cb594">Simulation::t</a></div><div class="ttdeci">double t</div><div class="ttdef"><b>Definition:</b> DEMND.h:92</div></div>
<div class="ttc" id="aclassSimulation_html_a97ea76d8dbe30376f60b3308f0bc856f"><div class="ttname"><a href="classSimulation.html#a97ea76d8dbe30376f60b3308f0bc856f">Simulation::Ghost</a></div><div class="ttdeci">vector&lt; uint32_t &gt; Ghost</div><div class="ttdef"><b>Definition:</b> DEMND.h:84</div></div>
<div class="ttc" id="aclassSimulation_html_abf0c3c4b447a95d9d03ce4ecb8dde8e6"><div class="ttname"><a href="classSimulation.html#abf0c3c4b447a95d9d03ce4ecb8dde8e6">Simulation::empty_array</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; empty_array</div><div class="ttdef"><b>Definition:</b> DEMND.h:81</div></div>
<div class="ttc" id="aclassSimulation_html_abf0d6ade6126c8d8bcc17c16fcc1c32c"><div class="ttname"><a href="classSimulation.html#abf0d6ade6126c8d8bcc17c16fcc1c32c">Simulation::TorqueOld</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; TorqueOld</div><div class="ttdef"><b>Definition:</b> DEMND.h:68</div></div>
<div class="ttc" id="aclassSimulation_html_ad2d47b656e6452943a83228cf0bdeb31"><div class="ttname"><a href="classSimulation.html#ad2d47b656e6452943a83228cf0bdeb31">Simulation::tnow</a></div><div class="ttdeci">clock_t tnow</div><div class="ttdef"><b>Definition:</b> DEMND.h:94</div></div>
<div class="ttc" id="aclassSimulation_html_ad661e05befbcf21f70fc2dc9594f570b"><div class="ttname"><a href="classSimulation.html#ad661e05befbcf21f70fc2dc9594f570b">Simulation::TorqueCorr</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; TorqueCorr</div><div class="ttdef"><b>Definition:</b> DEMND.h:73</div></div>
<div class="ttc" id="aclassSimulation_html_ada00ac80b5ad3a4b437dc34626d33e3a"><div class="ttname"><a href="classSimulation.html#ada00ac80b5ad3a4b437dc34626d33e3a">Simulation::X</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; X</div><div class="ttdef"><b>Definition:</b> DEMND.h:61</div></div>
<div class="ttc" id="aclassSimulation_html_ae0765646809d18926387ad69004f194f"><div class="ttname"><a href="classSimulation.html#ae0765646809d18926387ad69004f194f">Simulation::P</a></div><div class="ttdeci">Parameters&lt; d &gt; P</div><div class="ttdef"><b>Definition:</b> DEMND.h:59</div></div>
<div class="ttc" id="aclassSimulation_html_ae76c72cd7640bdb5c3e23d1445dcbdf3"><div class="ttname"><a href="classSimulation.html#ae76c72cd7640bdb5c3e23d1445dcbdf3">Simulation::Omega</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Omega</div><div class="ttdef"><b>Definition:</b> DEMND.h:64</div></div>
<div class="ttc" id="aclassSimulation_html_aef49d4beef65281ea392a0e5806d7399"><div class="ttname"><a href="classSimulation.html#aef49d4beef65281ea392a0e5806d7399">Simulation::WallForce</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; WallForce</div><div class="ttdef"><b>Definition:</b> DEMND.h:80</div></div>
<div class="ttc" id="aclassSimulation_html_af024b857f483ca4d9111487dae4e7633"><div class="ttname"><a href="classSimulation.html#af024b857f483ca4d9111487dae4e7633">Simulation::OmegaMag</a></div><div class="ttdeci">std::vector&lt; double &gt; OmegaMag</div><div class="ttdef"><b>Definition:</b> DEMND.h:70</div></div>
<div class="ttc" id="aclassSimulation_html_af2e37424452fc0690285d330c1290805"><div class="ttname"><a href="classSimulation.html#af2e37424452fc0690285d330c1290805">Simulation::step_forward_all</a></div><div class="ttdeci">void step_forward_all()</div><div class="ttdoc">Run the whole simulation as defined in the input script.</div><div class="ttdef"><b>Definition:</b> DEMND.h:189</div></div>
<div class="ttc" id="aclassSimulation_html_af5dbd055f9556c69b982a7f5f1a233d1"><div class="ttname"><a href="classSimulation.html#af5dbd055f9556c69b982a7f5f1a233d1">Simulation::setBoundary</a></div><div class="ttdeci">void setBoundary(int a, std::vector&lt; double &gt; loc)</div><div class="ttdef"><b>Definition:</b> DEMND.h:809</div></div>
<div class="ttc" id="aclassSimulation_html_afa3cd19e5b3c33933de66b06d00c084c"><div class="ttname"><a href="classSimulation.html#afa3cd19e5b3c33933de66b06d00c084c">Simulation::F</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; F</div><div class="ttdef"><b>Definition:</b> DEMND.h:65</div></div>
<div class="ttc" id="aclassTools__2D_html_a41814f9d41d72d83138f98caeaeba426"><div class="ttname"><a href="classTools__2D.html#a41814f9d41d72d83138f98caeaeba426">Tools_2D::contact_ellipse_disk</a></div><div class="ttdeci">static std::tuple&lt; double, double &gt; contact_ellipse_disk(std::vector&lt; double &gt; &amp;X, double a, double b, double cx, double cy, double gamma=0.1, double tol=1e-5)</div><div class="ttdef"><b>Definition:</b> Tools.h:62</div></div>
<div class="ttc" id="aclassTools_html"><div class="ttname"><a href="classTools.html">Tools</a></div><div class="ttdoc">Static class to handle multi-dimensional mathematics, and more. It gets specialised for speed with te...</div><div class="ttdef"><b>Definition:</b> Tools.h:101</div></div>
<div class="ttc" id="aclassTools_html_a02008248619a268d886047392c5b6afa"><div class="ttname"><a href="classTools.html#a02008248619a268d886047392c5b6afa">Tools::vAddScaled</a></div><div class="ttdeci">static void vAddScaled(v1d &amp;res, double v, cv1d &amp;a, cv1d &amp;b)</div><div class="ttdoc">Addition of 3 vectors in-place.</div><div class="ttdef"><b>Definition:</b> Tools.h:183</div></div>
<div class="ttc" id="aclassTools_html_a48628bbf3c0db32dd76257ee71bfcb3e"><div class="ttname"><a href="classTools.html#a48628bbf3c0db32dd76257ee71bfcb3e">Tools::vAddFew</a></div><div class="ttdeci">static void vAddFew(v1d &amp;res, cv1d &amp;a, cv1d &amp;b)</div><div class="ttdef"><b>Definition:</b> Tools.h:182</div></div>
<div class="ttc" id="aclassTools_html_ace2d91b2f88a22098e05da047389c129"><div class="ttname"><a href="classTools.html#ace2d91b2f88a22098e05da047389c129">Tools::vAddOne</a></div><div class="ttdeci">static void vAddOne(v1d &amp;res, cv1d &amp;a, v1d &amp;Corr)</div><div class="ttdoc">Addition of 2 vectors in-place with error correction (Kahan summation algorithm)</div><div class="ttdef"><b>Definition:</b> Tools.h:217</div></div>
<div class="ttc" id="aclassTools_html_acf8b7c2f6200ca67ea31099cc6612691"><div class="ttname"><a href="classTools.html#acf8b7c2f6200ca67ea31099cc6612691">Tools::vSubFew</a></div><div class="ttdeci">static void vSubFew(v1d &amp;res, cv1d &amp;a, cv1d &amp;b)</div><div class="ttdoc">Subtraction of 2 vectors .</div><div class="ttdef"><b>Definition:</b> Tools.h:185</div></div>
<div class="ttc" id="aclassTools_html_ae1c9d6305ea280d7be9a011056d5f9bc"><div class="ttname"><a href="classTools.html#ae1c9d6305ea280d7be9a011056d5f9bc">Tools::vSubScaled</a></div><div class="ttdeci">static void vSubScaled(v1d &amp;res, double v, cv1d &amp;a)</div><div class="ttdoc">Subtraction of a scaled vector .</div><div class="ttdef"><b>Definition:</b> Tools.h:186</div></div>
<div class="ttc" id="aclassXMLWriter_html"><div class="ttname"><a href="classXMLWriter.html">XMLWriter</a></div><div class="ttdef"><b>Definition:</b> Xml.h:28</div></div>
<div class="ttc" id="aclasscp_html"><div class="ttname"><a href="classcp.html">cp</a></div><div class="ttdoc">Contact properties class.</div><div class="ttdef"><b>Definition:</b> ContactList.h:59</div></div>
<div class="ttc" id="aclasscp_html_a0e2ea54c5799746e0fcc73ad85bb9081"><div class="ttname"><a href="classcp.html#a0e2ea54c5799746e0fcc73ad85bb9081">cp::contactlength</a></div><div class="ttdeci">double contactlength</div><div class="ttdoc">Length of the contact.</div><div class="ttdef"><b>Definition:</b> ContactList.h:104</div></div>
<div class="ttc" id="aclasscp_html_a48d0cbad59a1fe17b5002b30997ff5a7"><div class="ttname"><a href="classcp.html#a48d0cbad59a1fe17b5002b30997ff5a7">cp::j</a></div><div class="ttdeci">int j</div><div class="ttdoc">Index of second contacting particle or wall. If this is a wall contact, j=2*walldimension + (0 or 1 i...</div><div class="ttdef"><b>Definition:</b> ContactList.h:103</div></div>
<div class="ttc" id="aclasscp_html_a532976de3eaca669595936a9dff36f69"><div class="ttname"><a href="classcp.html#a532976de3eaca669595936a9dff36f69">cp::i</a></div><div class="ttdeci">int i</div><div class="ttdoc">Index of contacting particle.</div><div class="ttdef"><b>Definition:</b> ContactList.h:102</div></div>
<div class="ttc" id="aclasscp_html_a580937a3a7772290cd7102ebf3f63fa6"><div class="ttname"><a href="classcp.html#a580937a3a7772290cd7102ebf3f63fa6">cp::setinfo</a></div><div class="ttdeci">void setinfo(Action&lt; d &gt; *a)</div><div class="ttdoc">Set information for contact force.</div><div class="ttdef"><b>Definition:</b> ContactList.h:81</div></div>
<div class="ttc" id="aclasscp_html_a5ab3a9afca56ffd7798e9b3c40564dad"><div class="ttname"><a href="classcp.html#a5ab3a9afca56ffd7798e9b3c40564dad">cp::ghost</a></div><div class="ttdeci">uint32_t ghost</div><div class="ttdoc">Contain ghost information about ghost contact, cf detailed description.</div><div class="ttdef"><b>Definition:</b> ContactList.h:105</div></div>
<div class="ttc" id="aclasscp_html_adce38f7a307dd8a3d8d4c2248fe1dc7b"><div class="ttname"><a href="classcp.html#adce38f7a307dd8a3d8d4c2248fe1dc7b">cp::ghostdir</a></div><div class="ttdeci">uint32_t ghostdir</div><div class="ttdoc">Contain ghost information about ghost direction, cf detailed description.</div><div class="ttdef"><b>Definition:</b> ContactList.h:106</div></div>
<div class="ttc" id="aclasscpm_html"><div class="ttname"><a href="classcpm.html">cpm</a></div><div class="ttdoc">Contact properties for mesh contacts (mainly), including contact point location, specialising cp.</div><div class="ttdef"><b>Definition:</b> ContactList.h:150</div></div>
<div class="ttc" id="aemscripten__specific_8h_html"><div class="ttname"><a href="emscripten__specific_8h.html">emscripten_specific.h</a></div></div>
<div class="ttc" id="agroup__API_html_ga04e90115f462996d131656184e22cd91"><div class="ttname"><a href="group__API.html#ga04e90115f462996d131656184e22cd91">Simulation::setRadius</a></div><div class="ttdeci">void setRadius(int id, double radius)</div><div class="ttdoc">Set the radius of a specific particle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:712</div></div>
<div class="ttc" id="agroup__API_html_ga05c66f3e96abab1dde60a1ea6fbad592"><div class="ttname"><a href="group__API.html#ga05c66f3e96abab1dde60a1ea6fbad592">Simulation::setX</a></div><div class="ttdeci">void setX(std::vector&lt; std::vector&lt; double &gt; &gt; X_)</div><div class="ttdoc">Set the array of locations.</div><div class="ttdef"><b>Definition:</b> DEMND.h:764</div></div>
<div class="ttc" id="agroup__API_html_ga0eb8934c406d9a1eea3d72142de1cb89"><div class="ttname"><a href="group__API.html#ga0eb8934c406d9a1eea3d72142de1cb89">Simulation::setFrozen</a></div><div class="ttdeci">void setFrozen(int a)</div><div class="ttdoc">Freeze a single particle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:793</div></div>
<div class="ttc" id="agroup__API_html_ga0f3dbc7f5d50d71db205a8bb7270a868"><div class="ttname"><a href="group__API.html#ga0f3dbc7f5d50d71db205a8bb7270a868">Simulation::setAngularVelocity</a></div><div class="ttdeci">void setAngularVelocity(int id, v1d omega)</div><div class="ttdoc">Set the angular velocity of a single particle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:774</div></div>
<div class="ttc" id="agroup__API_html_ga1c98c8c77d3667385ed2da1c15fb8ff3"><div class="ttname"><a href="group__API.html#ga1c98c8c77d3667385ed2da1c15fb8ff3">Simulation::getContactInfos</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getContactInfos(int flags)</div><div class="ttdoc">Expose the array of contact information.</div><div class="ttdef"><b>Definition:</b> DEMND.h:731</div></div>
<div class="ttc" id="agroup__API_html_ga22a205b23e4dd5e9bf2c5687ac91cb14"><div class="ttname"><a href="group__API.html#ga22a205b23e4dd5e9bf2c5687ac91cb14">Simulation::fixParticle</a></div><div class="ttdeci">void fixParticle(int a, v1d loc)</div><div class="ttdoc">Set a single particle location, velocity, and angular velocity.</div><div class="ttdef"><b>Definition:</b> DEMND.h:782</div></div>
<div class="ttc" id="agroup__API_html_ga2afe3cf45586975ffff01d466e8f437c"><div class="ttname"><a href="group__API.html#ga2afe3cf45586975ffff01d466e8f437c">Simulation::getRadii</a></div><div class="ttdeci">std::vector&lt; double &gt; getRadii()</div><div class="ttdoc">Expose the array of radii.</div><div class="ttdef"><b>Definition:</b> DEMND.h:709</div></div>
<div class="ttc" id="agroup__API_html_ga3129fa33da12f5f4ae4772d35a24284b"><div class="ttname"><a href="group__API.html#ga3129fa33da12f5f4ae4772d35a24284b">Simulation::getOrientation</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getOrientation()</div><div class="ttdoc">Expose the array of orientation.</div><div class="ttdef"><b>Definition:</b> DEMND.h:805</div></div>
<div class="ttc" id="agroup__API_html_ga35da1ce034dd12fa4e52df7308b4a2c5"><div class="ttname"><a href="group__API.html#ga35da1ce034dd12fa4e52df7308b4a2c5">Simulation::interpret_command</a></div><div class="ttdeci">void interpret_command(string in)</div><div class="ttdoc">Interpret individual script command from string.</div><div class="ttdef"><b>Definition:</b> DEMND.h:181</div></div>
<div class="ttc" id="agroup__API_html_ga3e04516c50d59dfa46615be8c0253fe1"><div class="ttname"><a href="group__API.html#ga3e04516c50d59dfa46615be8c0253fe1">Simulation::step_forward</a></div><div class="ttdeci">void step_forward(int nt)</div><div class="ttdoc">Advance the simulation for nt steps (actual duration nt*dt).</div><div class="ttdef"><b>Definition:</b> DEMND.h:199</div></div>
<div class="ttc" id="agroup__API_html_ga42f68de4b70af6034f0e3430ad18fcde"><div class="ttname"><a href="group__API.html#ga42f68de4b70af6034f0e3430ad18fcde">Simulation::setMass</a></div><div class="ttdeci">void setMass(int id, double mass)</div><div class="ttdoc">Set the mass of a specific particle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:715</div></div>
<div class="ttc" id="agroup__API_html_ga7e57e1686d5ffd88091e2b2fb7420527"><div class="ttname"><a href="group__API.html#ga7e57e1686d5ffd88091e2b2fb7420527">Simulation::getVelocity</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getVelocity()</div><div class="ttdoc">Expose the array of velocities.</div><div class="ttdef"><b>Definition:</b> DEMND.h:718</div></div>
<div class="ttc" id="agroup__API_html_ga8543818667137a3859f76967f08c73a2"><div class="ttname"><a href="group__API.html#ga8543818667137a3859f76967f08c73a2">Simulation::setExternalForce</a></div><div class="ttdeci">void setExternalForce(int id, int duration, v1d force)</div><div class="ttdoc">Set an additional external force on a particle for a certain duration.</div><div class="ttdef"><b>Definition:</b> DEMND.h:833</div></div>
<div class="ttc" id="agroup__API_html_ga8f4a717588a487f02fd6226b31d31753"><div class="ttname"><a href="group__API.html#ga8f4a717588a487f02fd6226b31d31753">Simulation::finalise</a></div><div class="ttdeci">void finalise()</div><div class="ttdoc">Settles the simulation, closing open files etc.</div><div class="ttdef"><b>Definition:</b> DEMND.h:697</div></div>
<div class="ttc" id="agroup__API_html_gaa7fa3499c5a80bc2b1dc36183ba9caf0"><div class="ttname"><a href="group__API.html#gaa7fa3499c5a80bc2b1dc36183ba9caf0">Simulation::setVelocity</a></div><div class="ttdeci">void setVelocity(int id, v1d vel)</div><div class="ttdoc">Set the velocity of a single particle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:767</div></div>
<div class="ttc" id="agroup__API_html_gaa892abc9bf2f4101a63243adb9836f2c"><div class="ttname"><a href="group__API.html#gaa892abc9bf2f4101a63243adb9836f2c">Simulation::getContactForce</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getContactForce()</div><div class="ttdoc">DEPRECATED: Use getContactInfo with the appropriate flags instead. Expose the array of particle id an...</div><div class="ttdef"><b>Definition:</b> DEMND.h:724</div></div>
<div class="ttc" id="agroup__API_html_gaa93f4b63400d7d265968d429dba9fdee"><div class="ttname"><a href="group__API.html#gaa93f4b63400d7d265968d429dba9fdee">Simulation::getBoundary</a></div><div class="ttdeci">std::vector&lt; double &gt; getBoundary(int a)</div><div class="ttdoc">Expose the array of boundaries.</div><div class="ttdef"><b>Definition:</b> DEMND.h:808</div></div>
<div class="ttc" id="agroup__API_html_gaaae3ce9a68b9ac2886c0c6178da987ad"><div class="ttname"><a href="group__API.html#gaaae3ce9a68b9ac2886c0c6178da987ad">Simulation::getRotationRate</a></div><div class="ttdeci">std::vector&lt; double &gt; getRotationRate()</div><div class="ttdoc">Expose the array of orientation rate.</div><div class="ttdef"><b>Definition:</b> DEMND.h:721</div></div>
<div class="ttc" id="agroup__API_html_gac40eb65926ec79d05ab86d8f03d65a1e"><div class="ttname"><a href="group__API.html#gac40eb65926ec79d05ab86d8f03d65a1e">Simulation::getWallForce</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getWallForce()</div><div class="ttdoc">Expose the array of wall forces.</div><div class="ttdef"><b>Definition:</b> DEMND.h:819</div></div>
<div class="ttc" id="agroup__API_html_gac68aababf0ba558de5d808793efb1e6d"><div class="ttname"><a href="group__API.html#gac68aababf0ba558de5d808793efb1e6d">Simulation::getGravityAngle</a></div><div class="ttdeci">double getGravityAngle()</div><div class="ttdoc">Expose the current gravity angle.</div><div class="ttdef"><b>Definition:</b> DEMND.h:801</div></div>
<div class="ttc" id="agroup__API_html_gae5dc1304be206295da37e4045d95b3a9"><div class="ttname"><a href="group__API.html#gae5dc1304be206295da37e4045d95b3a9">Simulation::finalise_init</a></div><div class="ttdeci">void finalise_init()</div><div class="ttdoc">Tell NDDEM that the simulations are now initialised and we can start running.</div><div class="ttdef"><b>Definition:</b> DEMND.h:145</div></div>
<div class="ttc" id="agroup__API_html_gae92fc2ba0a8d73cf7bc7abd36a917cf1"><div class="ttname"><a href="group__API.html#gae92fc2ba0a8d73cf7bc7abd36a917cf1">Simulation::getTime</a></div><div class="ttdeci">double getTime()</div><div class="ttdoc">Expose the current time.</div><div class="ttdef"><b>Definition:</b> DEMND.h:798</div></div>
<div class="ttc" id="agroup__API_html_gaffb633e2c2c65ed82490c3e939f2a51b"><div class="ttname"><a href="group__API.html#gaffb633e2c2c65ed82490c3e939f2a51b">Simulation::getX</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; getX()</div><div class="ttdoc">Expose the array of locations.</div><div class="ttdef"><b>Definition:</b> DEMND.h:706</div></div>
<div class="ttc" id="agroup__DEM_html_ga09cbf4014b6f64277c0cfd25c1caad11"><div class="ttname"><a href="group__DEM.html#ga09cbf4014b6f64277c0cfd25c1caad11">Multiproc::delaying</a></div><div class="ttdeci">void delaying(int ID, int j, Action&lt; d &gt; &amp;act)</div><div class="ttdoc">Record the action to be added later to the relevent atom in sequencial settings, avoid potential race...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:205</div></div>
<div class="ttc" id="agroup__DEM_html_ga1a8e5f27dfca54cbdcebe441dae4d31e"><div class="ttname"><a href="group__DEM.html#ga1a8e5f27dfca54cbdcebe441dae4d31e">Tools::orthonormalise</a></div><div class="ttdeci">static void orthonormalise(v1d &amp;A)</div><div class="ttdoc">Orthonormalise A using the Gram-Shmidt process, in place.</div><div class="ttdef"><b>Definition:</b> Tools.h:741</div></div>
<div class="ttc" id="agroup__DEM_html_ga227c6e8a510dcf612c48e14113e2f030"><div class="ttname"><a href="group__DEM.html#ga227c6e8a510dcf612c48e14113e2f030">Tools::setzero</a></div><div class="ttdeci">static void setzero(v2d &amp;a)</div><div class="ttdoc">Set a matrix to zero in-place.</div><div class="ttdef"><b>Definition:</b> Tools.h:117</div></div>
<div class="ttc" id="agroup__DEM_html_ga2c16637999a27df000debc5d377fbd1f"><div class="ttname"><a href="group__DEM.html#ga2c16637999a27df000debc5d377fbd1f">Tools::unitvec</a></div><div class="ttdeci">static void unitvec(vector&lt; double &gt; &amp;v, int n)</div><div class="ttdoc">Construct a unit vector in place.</div><div class="ttdef"><b>Definition:</b> Tools.h:735</div></div>
<div class="ttc" id="agroup__DEM_html_ga39feb4da43311f97c104f2c798bca233"><div class="ttname"><a href="group__DEM.html#ga39feb4da43311f97c104f2c798bca233">Contacts::particle_particle</a></div><div class="ttdeci">void particle_particle(cv1d &amp;Xi, cv1d &amp;Vi, cv1d &amp;Omegai, double ri, double mi, cv1d &amp;Xj, cv1d &amp;Vj, cv1d &amp;Omegaj, double rj, double mj, cp&lt; d &gt; &amp;Contact, bool isdumptime)</div><div class="ttdoc">Force &amp; torque between 2 particles.</div><div class="ttdef"><b>Definition:</b> Contacts.h:171</div></div>
<div class="ttc" id="agroup__DEM_html_ga513959f26fd4469592593d8e13e8eba1"><div class="ttname"><a href="group__DEM.html#ga513959f26fd4469592593d8e13e8eba1">ExportData</a></div><div class="ttdeci">ExportData</div><div class="ttdef"><b>Definition:</b> Parameters.h:37</div></div>
<div class="ttc" id="agroup__DEM_html_ga52b72596f946f6e47a9c5c9079071431a717dc19d2859f49af215c07598ba3fe9"><div class="ttname"><a href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431a717dc19d2859f49af215c07598ba3fe9">vel</a></div><div class="ttdeci">@ vel</div><div class="ttdef"><b>Definition:</b> Typedefs.h:19</div></div>
<div class="ttc" id="agroup__DEM_html_ga52b72596f946f6e47a9c5c9079071431ae358f8d850aa0de45e1a1996e67d9bc5"><div class="ttname"><a href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae358f8d850aa0de45e1a1996e67d9bc5">omega</a></div><div class="ttdeci">@ omega</div><div class="ttdef"><b>Definition:</b> Typedefs.h:19</div></div>
<div class="ttc" id="agroup__DEM_html_ga52b72596f946f6e47a9c5c9079071431ae4fe62e6806a7eeb5dbb66ab0544f80a"><div class="ttname"><a href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431ae4fe62e6806a7eeb5dbb66ab0544f80a">radius</a></div><div class="ttdeci">@ radius</div><div class="ttdef"><b>Definition:</b> Typedefs.h:19</div></div>
<div class="ttc" id="agroup__DEM_html_ga52b72596f946f6e47a9c5c9079071431afe1b18e2fd39f763316753b044fbdb78"><div class="ttname"><a href="group__DEM.html#ga52b72596f946f6e47a9c5c9079071431afe1b18e2fd39f763316753b044fbdb78">mass</a></div><div class="ttdeci">@ mass</div><div class="ttdef"><b>Definition:</b> Typedefs.h:19</div></div>
<div class="ttc" id="agroup__DEM_html_ga576af8fc6304221f79cd88339097208e"><div class="ttname"><a href="group__DEM.html#ga576af8fc6304221f79cd88339097208e">Contacts::particle_mesh</a></div><div class="ttdeci">void particle_mesh(cv1d &amp;Xi, cv1d &amp;Vi, cv1d &amp;Omegai, double ri, double mi, cpm&lt; d &gt; &amp;Contact)</div><div class="ttdoc">Force &amp; torque between particle and mesh.</div><div class="ttdef"><b>Definition:</b> Contacts.h:401</div></div>
<div class="ttc" id="agroup__DEM_html_ga5b2f157533a646027c5b6027bf522af2"><div class="ttname"><a href="group__DEM.html#ga5b2f157533a646027c5b6027bf522af2">Contacts::particle_movingwall</a></div><div class="ttdeci">void particle_movingwall(cv1d &amp;Vi, cv1d &amp;Omegai, double ri, double mi, cv1d &amp;cn, cv1d &amp;Vj, cp&lt; d &gt; &amp;Contact)</div><div class="ttdoc">Force &amp; torque between a particle and a moving wall. Vj is the velocity of the wall at the contact po...</div><div class="ttdef"><b>Definition:</b> Contacts.h:331</div></div>
<div class="ttc" id="agroup__DEM_html_ga5e5d7c09c21dc9823729c0226c55f0c1"><div class="ttname"><a href="group__DEM.html#ga5e5d7c09c21dc9823729c0226c55f0c1">Tools::savetxt</a></div><div class="ttdeci">static int savetxt(char path[], const v2d &amp;table, char const header[])</div><div class="ttdef"><b>Definition:</b> Tools.h:349</div></div>
<div class="ttc" id="agroup__DEM_html_ga64473def2a41ed54010b316e8b9f3bf5"><div class="ttname"><a href="group__DEM.html#ga64473def2a41ed54010b316e8b9f3bf5">Multiproc::load_balance</a></div><div class="ttdeci">void load_balance(ContactStrategies contactstrategy)</div><div class="ttdoc">Modify the atom share between threads to achieve better load balance between the threads based on the...</div><div class="ttdef"><b>Definition:</b> Multiproc.h:257</div></div>
<div class="ttc" id="agroup__DEM_html_ga69aa29b598b851b0640aa225a9e5d61d"><div class="ttname"><a href="group__DEM.html#ga69aa29b598b851b0640aa225a9e5d61d">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> Typedefs.h:8</div></div>
<div class="ttc" id="agroup__DEM_html_ga902604fea6f0f763703abe9d7cd3b9a6"><div class="ttname"><a href="group__DEM.html#ga902604fea6f0f763703abe9d7cd3b9a6">Multiproc::delayedwall_clean</a></div><div class="ttdeci">void delayedwall_clean()</div><div class="ttdoc">Clean the record of the force on the wal.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:248</div></div>
<div class="ttc" id="agroup__DEM_html_ga981c61f50f6836f5e712818fbefcc5f6"><div class="ttname"><a href="group__DEM.html#ga981c61f50f6836f5e712818fbefcc5f6">Multiproc::contacts2array</a></div><div class="ttdeci">auto contacts2array(ExportData exp, cv2d &amp;X, Parameters&lt; d &gt; &amp;P)</div><div class="ttdoc">pack the contact data in a 2d array</div><div class="ttdef"><b>Definition:</b> Multiproc.h:374</div></div>
<div class="ttc" id="agroup__DEM_html_ga9a6ec0e1f8f2f49751587ecde95ac31a"><div class="ttname"><a href="group__DEM.html#ga9a6ec0e1f8f2f49751587ecde95ac31a">ContactListMesh::insert</a></div><div class="ttdeci">int insert(const cpm&lt; d &gt; &amp;a)</div><div class="ttdoc">Insert a contact, maintaining sorting with increasing i, and removing missing contacts on traversal.</div><div class="ttdef"><b>Definition:</b> ContactList.h:431</div></div>
<div class="ttc" id="agroup__DEM_html_ga9aa57026cccdc2a995d7dffe1e370e9c"><div class="ttname"><a href="group__DEM.html#ga9aa57026cccdc2a995d7dffe1e370e9c">Multiproc::delayed_clean</a></div><div class="ttdeci">void delayed_clean()</div><div class="ttdoc">Clean the record list.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:240</div></div>
<div class="ttc" id="agroup__DEM_html_gaaa7b9468d130f166b7824411f23f35b9"><div class="ttname"><a href="group__DEM.html#gaaa7b9468d130f166b7824411f23f35b9">ContactList::insert</a></div><div class="ttdeci">int insert(const cp&lt; d &gt; &amp;a)</div><div class="ttdoc">Insert a contact, maintaining sorting with increasing i, and removing missing contacts on traversal.</div><div class="ttdef"><b>Definition:</b> ContactList.h:410</div></div>
<div class="ttc" id="agroup__DEM_html_gab2e10cac5ba35b73fb2408dc4a216d04"><div class="ttname"><a href="group__DEM.html#gab2e10cac5ba35b73fb2408dc4a216d04">Tools::matmult</a></div><div class="ttdeci">static v1d matmult(cv1d &amp;A, cv1d &amp;B)</div><div class="ttdoc">Multiply 2 matrix together.</div><div class="ttdef"><b>Definition:</b> Tools.h:680</div></div>
<div class="ttc" id="agroup__DEM_html_gab4bc6d35a811dbdd4c1f943a6f679d63"><div class="ttname"><a href="group__DEM.html#gab4bc6d35a811dbdd4c1f943a6f679d63">bitdim</a></div><div class="ttdeci">unsigned int bitdim</div><div class="ttdef"><b>Definition:</b> Typedefs.h:17</div></div>
<div class="ttc" id="agroup__DEM_html_gabbda5dce569e943409a14e1add6185af"><div class="ttname"><a href="group__DEM.html#gabbda5dce569e943409a14e1add6185af">Tools::skewexpand</a></div><div class="ttdeci">static v1d skewexpand(cv1d &amp;A)</div><div class="ttdoc">Return the skew symetrix matrix M stored on d(d-1)/2 component as a full flattened matrix with d^2 co...</div><div class="ttdef"><b>Definition:</b> Tools.h:660</div></div>
<div class="ttc" id="agroup__DEM_html_gac20448335ecd8c809838b374144f5957"><div class="ttname"><a href="group__DEM.html#gac20448335ecd8c809838b374144f5957">toclean</a></div><div class="ttdeci">vector&lt; std::pair&lt; ExportType, ExportData &gt; &gt; * toclean</div><div class="ttdef"><b>Definition:</b> DEMND.cpp:20</div></div>
<div class="ttc" id="agroup__DEM_html_gac63743cf778b36c09f172ec8f1130fe3"><div class="ttname"><a href="group__DEM.html#gac63743cf778b36c09f172ec8f1130fe3">Contacts::particle_wall</a></div><div class="ttdeci">void particle_wall(cv1d &amp;Vi, cv1d &amp;Omegai, double ri, double mi, cv1d &amp;cn, cp&lt; d &gt; &amp;Contact)</div><div class="ttdoc">Force &amp; torque between a particle and a wall.</div><div class="ttdef"><b>Definition:</b> Contacts.h:261</div></div>
<div class="ttc" id="agroup__DEM_html_gac8eab4d302e80bfdef717daddf7bc194"><div class="ttname"><a href="group__DEM.html#gac8eab4d302e80bfdef717daddf7bc194">Multiproc::delayingwall</a></div><div class="ttdeci">void delayingwall(int ID, int j, Action&lt; d &gt; &amp;act)</div><div class="ttdoc">Record the action on the wall. Only usefull if the force on the wall needs to be calculated.</div><div class="ttdef"><b>Definition:</b> Multiproc.h:222</div></div>
<div class="ttc" id="agroup__DEM_html_gacabf51e402a05a98437894859ed3d834"><div class="ttname"><a href="group__DEM.html#gacabf51e402a05a98437894859ed3d834">xmlout</a></div><div class="ttdeci">XMLWriter * xmlout</div><div class="ttdef"><b>Definition:</b> DEMND.cpp:21</div></div>
<div class="ttc" id="agroup__DEM_html_gad1f0f6cfabfe20decb2e861a2b1fa4e9"><div class="ttname"><a href="group__DEM.html#gad1f0f6cfabfe20decb2e861a2b1fa4e9">Tools::setgravity</a></div><div class="ttdeci">static void setgravity(v2d &amp;a, v1d &amp;g, v1d &amp;m)</div><div class="ttdoc">Set the gravity. .</div><div class="ttdef"><b>Definition:</b> Tools.h:154</div></div>
<div class="ttc" id="agroup__DEM_html_gae0ec2e6c3cf902e89fb57ee9b5b16622"><div class="ttname"><a href="group__DEM.html#gae0ec2e6c3cf902e89fb57ee9b5b16622">Multiproc::splitcells</a></div><div class="ttdeci">void splitcells(int C)</div><div class="ttdef"><b>Definition:</b> Multiproc.h:196</div></div>
<div class="ttc" id="agroup__DEM_html_gae570fe4d2fd13665912fabd3abd276b2"><div class="ttname"><a href="group__DEM.html#gae570fe4d2fd13665912fabd3abd276b2">v1d</a></div><div class="ttdeci">vector&lt; double &gt; v1d</div><div class="ttdef"><b>Definition:</b> Typedefs.h:9</div></div>
<div class="ttc" id="agroup__DEM_html_gae580a0c4104608d38bc3b07d31a03180"><div class="ttname"><a href="group__DEM.html#gae580a0c4104608d38bc3b07d31a03180">Tools::surfacevelocity</a></div><div class="ttdeci">static void surfacevelocity(v1d &amp;res, cv1d &amp;p, double *com, double *vel_com, double *omega_com)</div><div class="ttdef"><b>Definition:</b> Tools.h:131</div></div>
<div class="ttc" id="agroup__DEM_html_gaeadcd7def825af49f5f3b33e62d94a18"><div class="ttname"><a href="group__DEM.html#gaeadcd7def825af49f5f3b33e62d94a18">Tools::initialise</a></div><div class="ttdeci">static void initialise()</div><div class="ttdoc">Initialise the member variables, in particular the variables to handle skew-symmetric flattened matri...</div><div class="ttdef"><b>Definition:</b> Tools.h:318</div></div>
<div class="ttc" id="agroup__DEM_html_gafb203c2bc8e3a924956443db4948635d"><div class="ttname"><a href="group__DEM.html#gafb203c2bc8e3a924956443db4948635d">Tools::norm</a></div><div class="ttdeci">static double norm(const vector&lt; double &gt; &amp;a)</div><div class="ttdoc">Norm of a vector.</div><div class="ttdef"><b>Definition:</b> Tools.h:119</div></div>
<div class="ttc" id="agroup__DEM_html_gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565"><div class="ttname"><a href="group__DEM.html#gga375410cc0bbd996376cbb08826d3b195a8653d5a76f09db2c3ee8cc2abbe37565">CELLS</a></div><div class="ttdeci">@ CELLS</div><div class="ttdef"><b>Definition:</b> Typedefs.h:22</div></div>
<div class="ttc" id="agroup__DEM_html_gga513959f26fd4469592593d8e13e8eba1a447abb17e794509db57d5dcb084124ec"><div class="ttname"><a href="group__DEM.html#gga513959f26fd4469592593d8e13e8eba1a447abb17e794509db57d5dcb084124ec">ExportData::IDS</a></div><div class="ttdeci">@ IDS</div></div>
<div class="ttc" id="agroup__DEM_html_gga513959f26fd4469592593d8e13e8eba1ad9d729a2fc731c33ea1360682d73aad5"><div class="ttname"><a href="group__DEM.html#gga513959f26fd4469592593d8e13e8eba1ad9d729a2fc731c33ea1360682d73aad5">ExportData::FN</a></div><div class="ttdeci">@ FN</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a3507764cffdfea213396f9d9eb30f870"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a3507764cffdfea213396f9d9eb30f870">WallType::ELLIPSE</a></div><div class="ttdeci">@ ELLIPSE</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a48d536b2de1195d0c9f6ea8ab884085e"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a48d536b2de1195d0c9f6ea8ab884085e">WallType::WALL</a></div><div class="ttdeci">@ WALL</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a6ef552336b9209dafccffb492dd3a80e"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6ef552336b9209dafccffb492dd3a80e">WallType::ROTATINGSPHERE</a></div><div class="ttdeci">@ ROTATINGSPHERE</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a6f7cea7381e843e2ee0338b4a92b0d43"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a6f7cea7381e843e2ee0338b4a92b0d43">WallType::SPHERE</a></div><div class="ttdeci">@ SPHERE</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a745727a64f32080cf213b668026dde48"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a745727a64f32080cf213b668026dde48">WallType::HEMISPHERE</a></div><div class="ttdeci">@ HEMISPHERE</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35a817a7e6f14396060c4e915adcaefb88e"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35a817a7e6f14396060c4e915adcaefb88e">WallType::PBC</a></div><div class="ttdeci">@ PBC</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35acdc57914080484150a75fb5aa18cdb73"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35acdc57914080484150a75fb5aa18cdb73">WallType::AXIALCYLINDER</a></div><div class="ttdeci">@ AXIALCYLINDER</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35ace8a104fadb84b89419953ea49da01b3">WallType::PBC_LE</a></div><div class="ttdeci">@ PBC_LE</div></div>
<div class="ttc" id="agroup__DEM_html_ggac5ecf92a792f505a64533e107971ae35aec0ee4a392a3223b0d108d177aaa8bd7"><div class="ttname"><a href="group__DEM.html#ggac5ecf92a792f505a64533e107971ae35aec0ee4a392a3223b0d108d177aaa8bd7">WallType::MOVINGWALL</a></div><div class="ttdeci">@ MOVINGWALL</div></div>
<div class="ttc" id="agroup__Texturing_html_ga234b9e563972a04e7cf0b991133f81fd"><div class="ttname"><a href="group__Texturing.html#ga234b9e563972a04e7cf0b991133f81fd">d</a></div><div class="ttdeci">uint d</div></div>
<div class="ttc" id="agroup__Texturing_html_ga7722c8ecbb62d99aee7ce68b1752f337"><div class="ttname"><a href="group__Texturing.html#ga7722c8ecbb62d99aee7ce68b1752f337">N</a></div><div class="ttdeci">int N</div></div>
<div class="ttc" id="anamespaceemscripten_html"><div class="ttname"><a href="namespaceemscripten.html">emscripten</a></div><div class="ttdef"><b>Definition:</b> emscripten_specific.h:148</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
